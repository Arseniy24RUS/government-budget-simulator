<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>–°–∏–º—É–ª—è—Ç–æ—Ä –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≥—É–±–µ—Ä–Ω–∞—Ç–æ—Ä–∞ —Å—É–±—ä–µ–∫—Ç–∞ –†–§</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f3f5f9;
      color: #222;
    }
    h1, h2, h3 {
      margin: 0 0 10px;
      font-weight: 600;
    }
    .hidden { display: none; }

    .page {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px 16px 40px;
    }

    .card {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
      padding: 20px 24px;
      margin-bottom: 20px;
    }

    .card.event-rare {
      border: 2px solid #ff9800;
      box-shadow: 0 0 0 1px rgba(255,152,0,0.25);
    }

    .intro-card {
      max-width: 720px;
      margin: 40px auto;
    }

    label {
      display: block;
      font-size: 0.9rem;
      margin-bottom: 4px;
      font-weight: 500;
    }
    input[type="text"], select {
      width: 100%;
      padding: 8px 10px;
      border-radius: 6px;
      border: 1px solid #ccd2e0;
      font-size: 0.95rem;
      margin-bottom: 12px;
    }
    input[type="number"] {
      padding: 5px 6px;
      border-radius: 6px;
      border: 1px solid #ccd2e0;
      font-size: 0.9rem;
    }

    button {
      border-radius: 6px;
      border: none;
      padding: 8px 16px;
      font-size: 0.95rem;
      cursor: pointer;
      background: #0b63e5;
      color: #fff;
      font-weight: 500;
    }
    button.secondary {
      background: #e4e7f0;
      color: #222;
    }
    button:disabled {
      opacity: 0.6;
      cursor: default;
    }

    .header-title {
      text-align: center;
      margin-top: 10px;
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 8px 14px;
      border-radius: 12px;
      background: #fff;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }
    .header-title img {
      width: 46px;
      height: 46px;
      object-fit: contain;
    }
    .page-header {
      display: flex;
      justify-content: center;
      margin-bottom: 12px;
    }

    .year-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 6px;
      gap: 12px;
      flex-wrap: wrap;
    }
    .year-bar span {
      font-size: 0.95rem;
    }
    .pill {
      padding: 4px 8px;
      border-radius: 20px;
      background: #e8f0ff;
      font-size: 0.85rem;
    }

    /* –¢–∞–π–º–ª–∞–π–Ω –ª–µ—Ç */
    .year-timeline {
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 4px;
      margin-top: 4px;
    }
    .timeline-step {
      display: flex;
      flex-direction: column;
      align-items: center;
      font-size: 0.75rem;
      color: #555;
    }
    .timeline-circle {
      width: 14px;
      height: 14px;
      border-radius: 50%;
      border: 2px solid #c0c4d6;
      background: #fff;
      margin-bottom: 2px;
    }
    .timeline-label {
      font-size: 0.7rem;
    }
    .timeline-step.past .timeline-circle {
      background: #4caf50;
      border-color: #4caf50;
    }
    .timeline-step.current .timeline-circle {
      background: #0b63e5;
      border-color: #0b63e5;
    }
    .timeline-step.future .timeline-circle {
      background: #fff;
      border-color: #c0c4d6;
    }

    .layout-two-columns {
      display: grid;
      grid-template-columns: minmax(0, 0.9fr) minmax(0, 1.1fr);
      gap: 20px;
      align-items: flex-start;
    }
    @media (max-width: 900px) {
      .layout-two-columns {
        grid-template-columns: 1fr;
      }
    }

    .player-zone {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
      margin-top: 10px;
    }

    .stats-zone {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
      margin-top: 10px;
    }

    .budget-input-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 6px;
    }
    .budget-input-row span {
      font-size: 0.9rem;
    }
    .budget-input-row span.budget-label {
      flex: 1;
    }
    .budget-input-row input[type="number"] {
      width: 70px;
      text-align: right;
    }
    .budget-input-row span.budget-amount {
      min-width: 110px;
      text-align: right;
      font-size: 0.8rem;
      color: #555;
      white-space: nowrap;
    }

    .budget-summary {
      font-size: 0.9rem;
      margin-top: 6px;
    }

    .budget-chart {
      margin-top: 8px;
    }

    .policy-panel h3 {
      margin-bottom: 4px;
    }
    .policy-panel small {
      display: block;
      font-size: 0.8rem;
      color: #666;
      margin-bottom: 8px;
    }
    .policy-category {
      margin-bottom: 10px;
      border-top: 1px solid #eef1f7;
      padding-top: 8px;
    }
    .policy-category-title {
      font-size: 0.9rem;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .policy-item {
      margin-bottom: 6px;
      font-size: 0.85rem;
      padding: 4px 0;
    }

    .policy-item-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
    }
    .policy-item-main {
      display: flex;
      align-items: center;
      gap: 6px;
      min-width: 0;
    }
    .policy-name {
      font-weight: 600;
      font-size: 0.9rem;
      cursor: pointer;
    }
    .policy-item-main input[type="checkbox"] {
      margin: 0;
    }
    .policy-cost-badge {
      font-size: 0.75rem;
      background: #eef1f7;
      border-radius: 999px;
      padding: 2px 8px;
      white-space: nowrap;
      color: #333;
    }
    .policy-icon {
      font-size: 1rem;
      width: 1.2em;
      text-align: center;
    }

    .policy-desc {
      font-size: 0.8rem;
      color: #555;
      margin-left: 22px;
      margin-top: 2px;
      margin-bottom: 2px;
    }

    .policy-effects-row {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 4px;
      margin-left: 22px;
      margin-bottom: 2px;
    }
    .effects-label {
      font-size: 0.75rem;
      font-weight: 500;
    }
    .effects-label.pos { color: #1b7e3c; }
    .effects-label.neg { color: #b3261e; }

    .policy-tag {
      font-size: 0.75rem;
      padding: 2px 6px;
      border-radius: 999px;
      background: #e0e7ff;
    }
    .policy-tag.positive {
      background: #e3f4e8;
      color: #1b7e3c;
    }
    .policy-tag.negative {
      background: #fde4e1;
      color: #b3261e;
    }

    .policy-limit {
      font-size: 0.8rem;
      margin-top: 6px;
    }

    #activePoliciesView {
      margin-top: 6px;
      font-size: 0.78rem;
    }
    #activePoliciesView .policy-tag {
      margin: 2px 2px 0 0;
    }

    .actions-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      margin-top: 10px;
      margin-bottom: 8px;
      flex-wrap: wrap;
    }

    .next-btn {  
      font-size: 1.05rem;
      padding: 12px 24px;
      background: linear-gradient(135deg, #0b63e5, #1a7bff);
      box-shadow: 0 6px 14px rgba(26,123,255,0.3);
    }

    .next-btn:hover:not(:disabled) {
      transform: translateY(-1px);
      box-shadow: 0 8px 16px rgba(26,123,255,0.35);
    }

    table {
      border-collapse: collapse;
      width: 100%;
      font-size: 0.85rem;
    }
    thead {
      background: #0b63e5;
      color: #fff;
    }
    th, td {
      padding: 6px 8px;
      border-bottom: 1px solid #e0e4f0;
      text-align: left;
      vertical-align: middle;
    }
    th:nth-child(1),
    td:nth-child(1) {
      width: 25%;
    }
    th:nth-child(2),
    th:nth-child(3),
    td:nth-child(2),
    td:nth-child(3) {
      width: 10%;
      text-align: right;
      white-space: nowrap;
    }

    .metric-progress {
      width: 100%;
      height: 10px;
      border-radius: 6px;
      background: #eef1f7;
      overflow: hidden;
    }
    .metric-progress-inner {
      height: 100%;
      width: 0%;
      background: #0073e6;
      transition: width 0.3s ease;
    }
    .metric-progress-inner.good { background: #28a745; }
    .metric-progress-inner.medium { background: #ff9800; }
    .metric-progress-inner.bad { background: #e53935; }

    #evaluation {
      margin-top: 16px;
      font-size: 0.9rem;
    }

    .chart-wrapper {
      margin-top: 16px;
    }

    .legend {
      font-size: 0.8rem;
      color: #555;
      margin-top: 6px;
    }

    /* –°–æ–±—ã—Ç–∏—è –≥–æ–¥–∞ */
    .event-title {
      margin-bottom: 4px;
    }
    .event-year-label {
      font-size: 0.9rem;
      color: #555;
      margin-bottom: 4px;
    }
    .event-option {
      margin-bottom: 4px;
      font-size: 0.85rem;
    }
    .event-option label {
      cursor: pointer;
    }
    .event-option input[type="radio"] {
      margin-right: 4px;
    }
    .event-badge {
      font-size: 0.8rem;
      margin-bottom: 4px;
    }
    .event-badge-rare {
      display: inline-block;
      padding: 2px 6px;
      border-radius: 12px;
      background: #fff3cd;
      color: #795548;
      font-weight: 500;
    }

    /* –õ–æ–≥ —Å–æ–±—ã—Ç–∏–π */
    .event-log-list {
      font-size: 0.8rem;
    }
    .event-log-item {
      padding: 3px 0;
      border-bottom: 1px dashed #e0e4f0;
    }
    .event-log-item:last-child {
      border-bottom: none;
    }
    .event-log-item.rare {
      background: #fff7e0;
      border-radius: 6px;
      padding: 4px 6px;
      margin: 2px -4px;
    }
    .event-log-year {
      font-weight: 600;
      margin-right: 4px;
    }
    .event-log-title {
      font-weight: 500;
    }
    .event-log-choice {
      color: #444;
    }

    /* –ì—Ä—É–ø–ø—ã –Ω–∞—Å–µ–ª–µ–Ω–∏—è */
    #groupsCard table th:nth-child(2),
    #groupsCard table td:nth-child(2),
    #groupsCard table th:nth-child(3),
    #groupsCard table td:nth-child(3) {
      width: 12%;
      text-align: right;
      white-space: nowrap;
    }

    /* –°–∏—Ç—É–∞—Ü–∏–∏ */
    .situation-item {
      font-size: 0.85rem;
      padding: 4px 0;
      border-bottom: 1px dashed #e0e4f0;
    }
    .situation-item:last-child {
      border-bottom: none;
    }
    .situation-title {
      font-weight: 600;
      margin-bottom: 2px;
    }
    .situation-desc {
      font-size: 0.8rem;
      color: #555;
      margin-bottom: 2px;
    }
    .situation-effects {
      font-size: 0.8rem;
      color: #333;
    }
  </style>
</head>
<body>
  <div class="page">
    <div class="page-header">
      <div class="header-title">
        <img src="logo.png" alt="–õ–æ–≥–æ—Ç–∏–ø —Å–∏–º—É–ª—è—Ç–æ—Ä–∞" />
        <h1>–°–∏–º—É–ª—è—Ç–æ—Ä –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≥—É–±–µ—Ä–Ω–∞—Ç–æ—Ä–∞ —Å—É–±—ä–µ–∫—Ç–∞ –†–§</h1>
      </div>
    </div>

    <!-- –í–≤–æ–¥ –§–ò–û, –≥—Ä—É–ø–ø—ã –∏ —Å—Ü–µ–Ω–∞—Ä–∏—è -->
    <div id="intro" class="card intro-card">
      <h2>–ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Å–∏–º—É–ª—è—Ü–∏–∏</h2>
      <p style="font-size:0.9rem; margin-bottom:16px;">
        –í–≤–µ–¥–∏—Ç–µ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ, –≤—ã–±–µ—Ä–∏—Ç–µ —Å—Ü–µ–Ω–∞—Ä–∏–π —Ä–µ–≥–∏–æ–Ω–∞ –∏ –Ω–∞–∂–º–∏—Ç–µ ¬´–ù–∞—á–∞—Ç—å —Å–∏–º—É–ª—è—Ü–∏—é¬ª.
        –¶–µ–ª—å ‚Äî –∑–∞ —Å—Ä–æ–∫ –¥–æ 2030 –≥–æ–¥–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–∏–±–ª–∏–∑–∏—Ç—å –∫–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Å—É–±—ä–µ–∫—Ç–∞
        –∫ —Ü–µ–ª—è–º, —Å–æ–±–ª—é–¥–∞—è –±—é–¥–∂–µ—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è, –Ω–∞–ª–æ–≥–æ–≤—É—é –ø–æ–ª–∏—Ç–∏–∫—É –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏,
        –∞ —Ç–∞–∫–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—è –≤—ã—Å–æ–∫—É—é –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É.
      </p>

      <label for="fio">–§–∞–º–∏–ª–∏—è, –∏–º—è, –æ—Ç—á–µ—Å—Ç–≤–æ</label>
      <input id="fio" type="text" placeholder="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á" />

      <label for="group">–ù–æ–º–µ—Ä –≥—Ä—É–ø–ø—ã</label>
      <input id="group" type="text" placeholder="–ì–ì–£–±–¥-01-25" />

      <label for="scenario">–°—Ü–µ–Ω–∞—Ä–∏–π —Ä–µ–≥–∏–æ–Ω–∞</label>
      <select id="scenario">
        <option value="baseline">–ë–∞–∑–æ–≤—ã–π: —Å—Ä–µ–¥–Ω–∏–µ —É—Å–ª–æ–≤–∏—è</option>
        <option value="demographic">–î–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π —Å–ø–∞–¥</option>
        <option value="ecological">–≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –∫—Ä–∏–∑–∏—Å</option>
        <option value="digital">–¶–∏—Ñ—Ä–æ–≤–∞—è —Ä–µ–≤–æ–ª—é—Ü–∏—è</option>
        <option value="aging">–°—Ç–∞—Ä–µ—é—â–µ–µ –Ω–∞—Å–µ–ª–µ–Ω–∏–µ</option>
        <option value="crisis">–≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π –∫—Ä–∏–∑–∏—Å</option>
      </select>

      <button id="startBtn" style="margin-top:6px;">–ù–∞—á–∞—Ç—å —Å–∏–º—É–ª—è—Ü–∏—é</button>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π —ç–∫—Ä–∞–Ω –∏–≥—Ä—ã -->
    <div id="game" class="hidden">
      <div class="card">
        <div class="year-bar">
          <span><strong>–ì–æ–¥:</strong> <span id="yearLabel"></span></span>
          <span class="pill"><strong>–°—Ç—É–¥–µ–Ω—Ç:</strong> <span id="studentLabel"></span></span>
          <span class="pill"><strong>–°—Ü–µ–Ω–∞—Ä–∏–π:</strong> <span id="scenarioLabel"></span></span>
          <span class="pill"><strong>–ò–Ω–¥–µ–∫—Å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (KPI):</strong> <span id="scoreLabel"></span></span>
          <span class="pill"><strong>–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–∞—Å–µ–ª–µ–Ω–∏—è:</strong> <span id="supportLabel"></span></span>
        </div>
        <div id="yearTimeline" class="year-timeline"></div>
      </div>

      <!-- –ë–ª–æ–∫ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è –≥–æ–¥–∞ -->
      <div id="eventCard" class="card">
        <h3 class="event-title">–°–æ–±—ã—Ç–∏–µ –≥–æ–¥–∞</h3>
        <div id="eventYearLabel" class="event-year-label"></div>
        <div id="eventBadge" class="event-badge"></div>
        <h4 id="eventTitle"></h4>
        <p id="eventDescription"></p>
        <div id="eventOptions"></div>
        <p id="eventHint" style="font-size:0.8rem;color:#555;margin-top:6px;">
          –í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ä–µ—à–µ–Ω–∏—è. –°–æ–±—ã—Ç–∏–µ –±—É–¥–µ—Ç —É—á—Ç–µ–Ω–æ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≥–æ–¥—É.
        </p>
      </div>

      <div class="player-zone">
        <!-- –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏ -->
        <div id="situationsCard" class="card">
          <h3>–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏</h3>
          <div id="situationsList"></div>
          <p style="font-size:0.8rem;color:#555;margin-top:6px;">
            –°–∏—Ç—É–∞—Ü–∏–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –ø—Ä–∏ –Ω–µ–±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω—ã—Ö —Å–æ—á–µ—Ç–∞–Ω–∏—è—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –∏ –µ–∂–µ–≥–æ–¥–Ω–æ –≤–ª–∏—è—é—Ç –Ω–∞ KPI,
            –ø–æ–∫–∞ –≤—ã –Ω–µ –∏—Å–ø—Ä–∞–≤–∏—Ç–µ –∏—Å—Ö–æ–¥–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã (–ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –∏ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç—å –≥—Ä—É–ø–ø).
          </p>
        </div>

        <div class="layout-two-columns">
          <!-- –ë—é–¥–∂–µ—Ç -->
          <div class="card">
            <h3>–ë—é–¥–∂–µ—Ç –∏ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è</h3>
            <p style="font-size:0.85rem; color:#555; margin-top:0;">
              –ë–∞–∑–æ–≤—ã–π –¥–æ—Ö–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞: –æ–∫–æ–ª–æ 800 –º–ª—Ä–¥ ‚ÇΩ –≤ –≥–æ–¥. –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –¥–æ—Ö–æ–¥ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –¥–æ—Ö–æ–¥–æ–≤ –Ω–∞—Å–µ–ª–µ–Ω–∏—è,
              –Ω–∞–ª–æ–≥–æ–≤–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ –≤–æ–∑–≤—Ä–∞—Ç–∞ –ø—Ä–æ—à–ª—ã—Ö –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π.
            </p>

            <h4 style="margin-top:4px; margin-bottom:4px; font-size:0.9rem;">–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –±—é–¥–∂–µ—Ç–∞ –ø–æ –±–ª–æ–∫–∞–º (%)</h4>
            <div id="budgetInputs"></div>
            <div id="budgetSummary" class="budget-summary"></div>
            <div id="budgetMoney" class="budget-summary" style="margin-top:4px; color:#444;"></div>

            <div class="budget-chart">
              <canvas id="budgetPie" height="140"></canvas>
            </div>

            <hr style="margin:10px 0; border:none; border-top:1px solid #e0e4f0;" />

            <h4 style="margin:4px 0; font-size:0.9rem;">–ù–∞–ª–æ–≥–æ–≤–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞</h4>
            <label for="taxLevel" style="margin-bottom:2px;">–£—Ä–æ–≤–µ–Ω—å –Ω–∞–ª–æ–≥–æ–≤–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏</label>
            <select id="taxLevel">
              <option value="low">–ù–∏–∑–∫–∞—è ‚Äî ‚Üì –¥–æ—Ö–æ–¥ –±—é–¥–∂–µ—Ç–∞, ‚Üë —É—Ä–æ–≤–µ–Ω—å –∂–∏–∑–Ω–∏</option>
              <option value="medium" selected>–£–º–µ—Ä–µ–Ω–Ω–∞—è ‚Äî –±–∞–ª–∞–Ω—Å</option>
              <option value="high">–í—ã—Å–æ–∫–∞—è ‚Äî ‚Üë –¥–æ—Ö–æ–¥ –±—é–¥–∂–µ—Ç–∞, ‚Üì –∫–∞—á–µ—Å—Ç–≤–æ –∂–∏–∑–Ω–∏</option>
            </select>

            <h4 style="margin:8px 0 4px; font-size:0.9rem;">–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–π —Ñ–æ–Ω–¥</h4>
            <label for="investmentShare" style="margin-bottom:2px;">–î–æ–ª—è –±—é–¥–∂–µ—Ç–∞, –Ω–∞–ø—Ä–∞–≤–ª—è–µ–º–∞—è –≤ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–π —Ñ–æ–Ω–¥, %</label>
            <input id="investmentShare" type="number" min="0" max="30" step="1" value="10" />

            <label for="investmentHorizon" style="margin-top:6px; margin-bottom:2px;">–ì–æ—Ä–∏–∑–æ–Ω—Ç –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π (–ª–µ—Ç)</label>
            <select id="investmentHorizon">
              <option value="2">2 –≥–æ–¥–∞</option>
              <option value="3" selected>3 –≥–æ–¥–∞</option>
              <option value="4">4 –≥–æ–¥–∞</option>
            </select>

            <p style="font-size:0.8rem; color:#555; margin-top:4px;">
              –ß–µ–º –±–æ–ª—å—à–µ –¥–æ–ª—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π –∏ —Å—Ä–æ–∫ –æ–∂–∏–¥–∞–Ω–∏—è, —Ç–µ–º —Å–∏–ª—å–Ω–µ–µ –≤—ã—Ä–∞—Å—Ç–µ—Ç –±—é–¥–∂–µ—Ç –≤ –±—É–¥—É—â–µ–º,
              –Ω–æ —Ç–µ–º –º–µ–Ω—å—à–µ —Å—Ä–µ–¥—Å—Ç–≤ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –Ω–∞ —Ç–µ–∫—É—â–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã.
            </p>
          </div>

          <!-- –£–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è -->
          <div class="card policy-panel">
            <h3>–£–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è</h3>
            <small>
              –û—Ç–º–µ—Ç—å—Ç–µ –º–µ—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å. –£ –∫–∞–∂–¥–æ–π –º–µ—Ä—ã –µ—Å—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –≤ –º–ª—Ä–¥ ‚ÇΩ –≤ –≥–æ–¥.
              –°—É–º–º–∞—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –º–µ—Ä –≤ –∫–∞–∂–¥–æ–º –±–ª–æ–∫–µ –Ω–µ –¥–æ–ª–∂–Ω–∞ –ø—Ä–µ–≤—ã—à–∞—Ç—å –±—é–¥–∂–µ—Ç —ç—Ç–æ–≥–æ –±–ª–æ–∫–∞
              (–≤ –º–ª—Ä–¥ ‚ÇΩ), –∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å –Ω–µ –±–æ–ª–µ–µ 12 –º–µ—Ä.
            </small>
            <div id="policyContainer"></div>
            <div class="policy-limit">
              –í—ã–±—Ä–∞–Ω–æ –º–µ—Ä: <span id="policyCount">0</span> / <span id="policyLimit"></span>
            </div>
            <div id="activePoliciesView"></div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="actions-bar">
          <div>
            <button id="nextBtn" class="next-btn">–°–ª–µ–¥—É—é—â–∏–π –≥–æ–¥</button>
            <button id="resetBtn" class="secondary">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
          </div>
          <div style="font-size:0.8rem; color:#555;">
            –°–∏–º—É–ª—è—Ü–∏—è –∏–¥—ë—Ç —Å 2025 –ø–æ 2030 –≥–æ–¥. –í –∫–æ–Ω—Ü–µ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –∏–Ω—Ç–µ–≥—Ä–∞–ª—å–Ω—É—é –æ—Ü–µ–Ω–∫—É:
            –ø–æ KPI –∏ –ø–æ –ø–æ–¥–¥–µ—Ä–∂–∫–µ –Ω–∞—Å–µ–ª–µ–Ω–∏—è.
          </div>
        </div>
        <p style="font-size:0.85rem; color:#444; margin:0 0 6px 0;">–°–Ω–∞—á–∞–ª–∞ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ä–µ—à–µ–Ω–∏—è, –∑–∞—Ç–µ–º –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≥–æ–¥—É.</p>
      </div>

      <div class="stats-zone">
        <div class="card">
          <h3>–ö–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</h3>
          <table>
            <thead>
              <tr>
                <th>–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å</th>
                <th>–¢–µ–∫—É—â–µ–µ</th>
                <th>–¶–µ–ª—å</th>
                <th>–ü—Ä–æ–≥—Ä–µ—Å—Å</th>
                <th>–í–ª–∏—è—é—â–∏–µ –º–µ—Ä—ã</th>
              </tr>
            </thead>
            <tbody id="metricsTableBody"></tbody>
          </table>
          <div class="legend">
            –ó–µ–ª—ë–Ω—ã–π ‚Äî –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –±–ª–∏–∑–æ–∫ –∫ —Ü–µ–ª–∏ (&gt; 80%), –æ—Ä–∞–Ω–∂–µ–≤—ã–π ‚Äî —Å—Ä–µ–¥–Ω–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å (50‚Äì80%),
            –∫—Ä–∞—Å–Ω—ã–π ‚Äî –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ –æ—Ç—Å—Ç–∞–≤–∞–Ω–∏–µ (&lt; 50%).
          </div>

          <div class="chart-wrapper">
            <canvas id="scoreChart" height="80"></canvas>
          </div>

          <div class="chart-wrapper">
            <h3>–ù–∞–≥—Ä—É–∑–∫–∞ –ø–æ –±–ª–æ–∫–∞–º</h3>
            <canvas id="loadChart" height="80"></canvas>
          </div>

          <div id="evaluation" class="hidden"></div>
        </div>

        <div class="layout-two-columns">
          <!-- –õ–æ–≥ —Å–æ–±—ã—Ç–∏–π -->
          <div id="eventLogCard" class="card">
            <h3>–õ–æ–≥ —Å–æ–±—ã—Ç–∏–π</h3>
            <div id="eventLog" class="event-log-list"></div>
          </div>

          <!-- –ì—Ä—É–ø–ø—ã –Ω–∞—Å–µ–ª–µ–Ω–∏—è -->
          <div id="groupsCard" class="card">
            <h3>–ì—Ä—É–ø–ø—ã –Ω–∞—Å–µ–ª–µ–Ω–∏—è –∏ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞</h3>
            <p style="font-size:0.8rem;color:#555;margin-bottom:8px;">
              –£ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã –Ω–∞—Å–µ–ª–µ–Ω–∏—è —Å–≤–æ–π —É—Ä–æ–≤–µ–Ω—å —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏. –ò—Ç–æ–≥–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å ¬´–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–∞—Å–µ–ª–µ–Ω–∏—è¬ª
              —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ –≤–∑–≤–µ—à–µ–Ω–Ω–∞—è —Å—É–º–º–∞ –ø–æ –≤—Å–µ–º –≥—Ä—É–ø–ø–∞–º –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —à–∞–ø–∫–µ.
            </p>
            <table>
              <thead>
                <tr>
                  <th>–ì—Ä—É–ø–ø–∞</th>
                  <th>–î–æ–ª—è</th>
                  <th>–£–¥–æ–≤–ª.</th>
                  <th>–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä</th>
                </tr>
              </thead>
              <tbody id="groupsTableBody"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const startYear = 2025;
      const endYear   = 2030;
      const maxPolicies = 12;

      const categories = [
        { id: 'social',   name: '–°–æ—Ü–∏–∞–ª—å–Ω–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞' },
        { id: 'health',   name: '–ó–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ' },
        { id: 'edu',      name: '–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏ –∫—É–ª—å—Ç—É—Ä–∞' },
        { id: 'infra',    name: '–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ —Å—Ä–µ–¥–∞' },
        { id: 'economy',  name: '–≠–∫–æ–Ω–æ–º–∏–∫–∞ –∏ —Ü–∏—Ñ—Ä–æ–≤–∏–∑–∞—Ü–∏—è' }
      ];

      const metricsConfig = [
        { id: 'trust',       name: '–î–æ–≤–µ—Ä–∏–µ –∫ –≤–ª–∞—Å—Ç–∏',                         base: 50,  target: 70, min: 0,   max: 100, weight: 1.2 },
        { id: 'population',  name: '–ß–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –Ω–∞—Å–µ–ª–µ–Ω–∏—è (–∏–Ω–¥–µ–∫—Å)',           base: 100, target: 105, min: 80, max: 120, weight: 1.1 },
        { id: 'tfr',         name: '–°—É–º–º–∞—Ä–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–æ–∂–¥–∞–µ–º–æ—Å—Ç–∏',       base: 1.3, target: 1.6, min: 0.7,max: 2.1, weight: 1.1 },
        { id: 'life',        name: '–û–∂–∏–¥–∞–µ–º–∞—è –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∂–∏–∑–Ω–∏',       base: 74,  target: 78, min: 60, max: 85,  weight: 1.1 },
        { id: 'poverty',     name: '–£—Ä–æ–≤–µ–Ω—å –±–µ–¥–Ω–æ—Å—Ç–∏ (–º–µ–Ω—å—à–µ –ª—É—á—à–µ)',         base: 15,  target: 7,  min: 3,  max: 25,  weight: 1.1, inverted: true },
        { id: 'sport',       name: '–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç—å —Ñ–∏–∑–∫—É–ª—å—Ç—É—Ä–æ–π –∏ —Å–ø–æ—Ä—Ç–æ–º',base: 40,  target: 60, min: 20, max: 90,  weight: 0.8 },
        { id: 'education',   name: '–£—Ä–æ–≤–µ–Ω—å –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏ –∫–∞–¥—Ä—ã',             base: 65,  target: 80, min: 40, max: 100, weight: 1.0 },
        { id: 'income',      name: '–†–æ—Å—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ –¥–æ—Ö–æ–¥–∞ –Ω–∞—Å–µ–ª–µ–Ω–∏—è (–∏–Ω–¥–µ–∫—Å)',base: 100, target: 120,min: 80, max: 130, weight: 1.1 },
        { id: 'investment',  name: '–†–æ—Å—Ç –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π (–∏–Ω–¥–µ–∫—Å)',                base: 100, target: 120,min: 70, max: 140, weight: 0.9 },
        { id: 'sme_income',  name: '–î–æ—Ö–æ–¥ –Ω–∞ –æ–¥–Ω–æ–≥–æ —Ä–∞–±–æ—Ç–Ω–∏–∫–∞ –ú–°–ü (–∏–Ω–¥–µ–∫—Å)',  base: 100, target: 120,min: 70, max: 150, weight: 0.9 },
        { id: 'environment', name: '–ö–∞—á–µ—Å—Ç–≤–æ –æ–∫—Ä—É–∂–∞—é—â–µ–π —Å—Ä–µ–¥—ã',               base: 55,  target: 80, min: 30, max: 100, weight: 0.9 },
        { id: 'digital',     name: '–¶–∏—Ñ—Ä–æ–≤–∞—è –∑—Ä–µ–ª–æ—Å—Ç—å –≥–æ—Å—É–ø—Ä–∞–≤–ª–µ–Ω–∏—è',         base: 40,  target: 70, min: 20, max: 100, weight: 1.0 }
      ];

      // –ì—Ä—É–ø–ø—ã –Ω–∞—Å–µ–ª–µ–Ω–∏—è
      const groupsConfig = [
        {
          id: 'families',
          name: '–°–µ–º—å–∏ —Å –¥–µ—Ç—å–º–∏',
          electorateWeight: 0.25,
          metrics: { tfr: 1.0, poverty: 0.9, trust: 0.8, income: 0.6, environment: 0.4 }
        },
        {
          id: 'pensioners',
          name: '–ü–æ–∂–∏–ª—ã–µ',
          electorateWeight: 0.2,
          metrics: { life: 1.0, poverty: 0.8, trust: 0.7, sport: 0.4, environment: 0.5 }
        },
        {
          id: 'business',
          name: '–ë–∏–∑–Ω–µ—Å –∏ –ú–°–ü',
          electorateWeight: 0.2,
          metrics: { income: 1.0, sme_income: 1.0, investment: 0.8, digital: 0.6 }
        },
        {
          id: 'youth',
          name: '–ú–æ–ª–æ–¥—ë–∂—å',
          electorateWeight: 0.15,
          metrics: { education: 1.0, digital: 0.9, sport: 0.7, income: 0.5, trust: 0.4 }
        },
        {
          id: 'budget',
          name: '–ë—é–¥–∂–µ—Ç–Ω–∏–∫–∏ –∏ –≥–æ—Å—Å–ª—É–∂–∞—â–∏–µ',
          electorateWeight: 0.1,
          metrics: { trust: 1.0, income: 0.7, education: 0.6, digital: 0.4 }
        },
        {
          id: 'activists',
          name: '–≠–∫–æ–ª–æ–≥–∏ –∏ –≥–æ—Ä–æ–¥—Å–∫–∏–µ –∞–∫—Ç–∏–≤–∏—Å—Ç—ã',
          electorateWeight: 0.1,
          metrics: { environment: 1.0, sport: 0.4, trust: 0.5, investment: 0.4, digital: 0.3 }
        }
      ];

      const scenarios = {
        baseline: {
          name: '–ë–∞–∑–æ–≤—ã–π',
          description: '–°—Ä–µ–¥–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –ø–æ –≤—Å–µ–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º.',
          mods: {}
        },
        demographic: {
          name: '–î–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π —Å–ø–∞–¥',
          description: '–ù–∏–∑–∫–∞—è —Ä–æ–∂–¥–∞–µ–º–æ—Å—Ç—å –∏ —Å–æ–∫—Ä–∞—â–∞—é—â–∞—è—Å—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –Ω–∞—Å–µ–ª–µ–Ω–∏—è.',
          mods: { population: -5, tfr: -0.2, income: -5 }
        },
        ecological: {
          name: '–≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –∫—Ä–∏–∑–∏—Å',
          description: '–°–∏–ª—å–Ω–æ–µ –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–µ —Å—Ä–µ–¥—ã, –Ω–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∂–∏–∑–Ω–∏.',
          mods: { environment: -15, life: -3, trust: -5 }
        },
        digital: {
          name: '–¶–∏—Ñ—Ä–æ–≤–∞—è —Ä–µ–≤–æ–ª—é—Ü–∏—è',
          description: '–í—ã—Å–æ–∫–∞—è —Ü–∏—Ñ—Ä–æ–≤–∞—è –∑—Ä–µ–ª–æ—Å—Ç—å –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏, –Ω–æ —Ä–∞—Å—Ç—ë—Ç –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–æ.',
          mods: { digital: +15, investment: +10, sme_income: +10, poverty: +2 }
        },
        aging: {
          name: '–°—Ç–∞—Ä–µ—é—â–µ–µ –Ω–∞—Å–µ–ª–µ–Ω–∏–µ',
          description: '–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∂–∏–∑–Ω–∏ –∏ –Ω–∏–∑–∫–∞—è —Ä–æ–∂–¥–∞–µ–º–æ—Å—Ç—å.',
          mods: { life: +3, tfr: -0.2, population: -3, income: -3 }
        },
        crisis: {
          name: '–≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π –∫—Ä–∏–∑–∏—Å',
          description: '–ü–∞–¥–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–æ–≤ –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π, —Ä–æ—Å—Ç –±–µ–¥–Ω–æ—Å—Ç–∏.',
          mods: { income: -10, investment: -10, poverty: +4, trust: -5 }
        }
      };

      // –ò–∫–æ–Ω–∫–∏ –¥–ª—è –ø–æ–ª–∏—Ç–∏–∫
      const policyIcons = {
        children_benefits:    'üë∂',
        multi_child_support:  'üë®‚Äçüë©‚Äçüëß‚Äçüë¶',
        volunteers:           'ü§ù',
        mortgage:             'üè†',
        pensioners:           'üëµ',
        hospitals:            'üè•',
        sport_infra:          'üèüÔ∏è',
        preventive_programs:  'ü©∫',
        sanatoriums:          '‚ô®Ô∏è',
        schools:              'üè´',
        talent_programs:      'üéì',
        scholarships:         'üí≥',
        digital_universities: 'üíª',
        housing_construction: 'üèóÔ∏è',
        public_transport:     'üöå',
        green_city:           'üå≥',
        energy_efficiency:    'üí°',
        sme_subsidies:        'üè™',
        tax_reform:           'üí∞',
        it_industry:          'üñ•Ô∏è',
        tourism_clusters:     'üó∫Ô∏è',
        startups:             'üöÄ'
      };
      const categoryIcons = {
        social:  '‚ù§Ô∏è',
        health:  '‚öïÔ∏è',
        edu:     'üìö',
        infra:   'üèôÔ∏è',
        economy: 'üìà'
      };

      function getPolicyIcon(p) {
        return policyIcons[p.id] || categoryIcons[p.category] || '‚öôÔ∏è';
      }

      // –ü–æ–ª–∏—Ç–∏–∫–∏: cost ‚Äî –º–ª—Ä–¥ ‚ÇΩ / –≥–æ–¥
      const policies = [
        // –°–æ—Ü–∏–∞–ª—å–Ω–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞
        {
          id: 'children_benefits',
          category: 'social',
          name: '–£–≤–µ–ª–∏—á–∏—Ç—å –¥–µ—Ç—Å–∫–∏–µ –ø–æ—Å–æ–±–∏—è',
          cost: 40,
          description: '–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–µ–º–µ–π —Å –¥–µ—Ç—å–º–∏.',
          effects:     { tfr: +0.05, poverty: -0.4, trust: +0.6, population: +0.4 },
          sideEffects: { investment: -0.4 }
        },
        {
          id: 'multi_child_support',
          category: 'social',
          name: '–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–≥–æ–¥–µ—Ç–Ω—ã—Ö —Å–µ–º–µ–π',
          cost: 35,
          description: '–¶–µ–ª–µ–≤—ã–µ –º–µ—Ä—ã –¥–ª—è —Å–µ–º–µ–π —Å 3+ –¥–µ—Ç—å–º–∏.',
          effects:     { tfr: +0.06, poverty: -0.3, trust: +0.4, population: +0.5 },
          sideEffects: { income: -0.5 }
        },
        {
          id: 'volunteers',
          category: 'social',
          name: '–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–æ–ª–æ–Ω—Ç—ë—Ä—Å–∫–∏—Ö –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤',
          cost: 15,
          description: '–†–∞–∑–≤–∏—Ç–∏–µ –¥–æ–±—Ä–æ–≤–æ–ª—å—á–µ—Å—Ç–≤–∞ –∏ –ù–ö–û.',
          effects:     { trust: +0.6, sport: +1.0, environment: +0.8 },
          sideEffects: {}
        },
        {
          id: 'mortgage',
          category: 'social',
          name: '–ü—Ä–æ–≥—Ä–∞–º–º–∞ –ª—å–≥–æ—Ç–Ω–æ–π –∏–ø–æ—Ç–µ–∫–∏',
          cost: 45,
          description: '–£–ª—É—á—à–µ–Ω–∏–µ –∂–∏–ª–∏—â–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π.',
          effects:     { poverty: -0.5, population: +0.6, trust: +0.3 },
          sideEffects: { environment: -0.6 }
        },
        {
          id: 'pensioners',
          category: 'social',
          name: '–ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø–µ–Ω—Å–∏–æ–Ω–µ—Ä–æ–≤',
          cost: 35,
          description: '–°–æ—Ü–ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç–∞—Ä—à–µ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è.',
          effects:     { poverty: -0.4, life: +0.4, trust: +0.8 },
          sideEffects: { investment: -0.3 }
        },

        // –ó–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
        {
          id: 'hospitals',
          category: 'health',
          name: '–ú–æ–¥–µ—Ä–Ω–∏–∑–∞—Ü–∏—è –±–æ–ª—å–Ω–∏—Ü',
          cost: 50,
          description: '–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è.',
          effects:     { life: +0.8, trust: +0.3, sport: +0.5 },
          sideEffects: { investment: -0.3 }
        },
        {
          id: 'sport_infra',
          category: 'health',
          name: '–†–∞–∑–≤–∏—Ç–∏–µ —Å–ø–æ—Ä—Ç–∏–≤–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã',
          cost: 30,
          description: '–°—Ç–∞–¥–∏–æ–Ω—ã, –§–û–ö–∏, –ø–ª–æ—â–∞–¥–∫–∏.',
          effects:     { sport: +2.0, life: +0.3, tfr: +0.02 },
          sideEffects: { environment: -0.3 }
        },
        {
          id: 'preventive_programs',
          category: 'health',
          name: '–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π',
          cost: 25,
          description: '–°–∫—Ä–∏–Ω–∏–Ω–≥, –¥–∏—Å–ø–∞–Ω—Å–µ—Ä–∏–∑–∞—Ü–∏—è.',
          effects:     { life: +0.7, poverty: -0.2 },
          sideEffects: {}
        },
        {
          id: 'sanatoriums',
          category: 'health',
          name: '–°–∞–Ω–∞—Ç–æ—Ä–Ω–æ-–∫—É—Ä–æ—Ä—Ç–Ω–æ–µ –ª–µ—á–µ–Ω–∏–µ',
          cost: 20,
          description: '–†–∞–∑–≤–∏—Ç–∏–µ —Å–∞–Ω–∞—Ç–æ—Ä–∏–µ–≤ –∏ –∫—É—Ä–æ—Ä—Ç–æ–≤.',
          effects:     { life: +0.4, environment: +0.5, investment: +0.5 },
          sideEffects: { income: -0.3 }
        },

        // –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏ –∫—É–ª—å—Ç—É—Ä–∞
        {
          id: 'schools',
          category: 'edu',
          name: '–†–µ—Ñ–æ—Ä–º–∞ —à–∫–æ–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è',
          cost: 35,
          description: '–ö–∞—á–µ—Å—Ç–≤–æ –æ–±—â–µ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è.',
          effects:     { education: +2.0, trust: +0.3 },
          sideEffects: {}
        },
        {
          id: 'talent_programs',
          category: 'edu',
          name: '–ü—Ä–æ–≥—Ä–∞–º–º—ã —Ä–∞–∑–≤–∏—Ç–∏—è —Ç–∞–ª–∞–Ω—Ç–æ–≤',
          cost: 25,
          description: '–û–¥–∞—Ä—ë–Ω–Ω—ã–µ –¥–µ—Ç–∏ –∏ –º–æ–ª–æ–¥—ë–∂—å.',
          effects:     { education: +1.3, sme_income: +0.7, investment: +0.4 },
          sideEffects: {}
        },
        {
          id: 'scholarships',
          category: 'edu',
          name: '–°—Ç–∏–ø–µ–Ω–¥–∏–∏ –∏ –º–µ—Ä—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤',
          cost: 25,
          description: '–ü–æ–≤—ã—à–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è.',
          effects:     { education: +1.5, poverty: -0.3, trust: +0.2 },
          sideEffects: { income: -0.2 }
        },
        {
          id: 'digital_universities',
          category: 'edu',
          name: '–¶–∏—Ñ—Ä–æ–≤—ã–µ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç—ã',
          cost: 20,
          description: 'IT-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –º–∞–≥–∏—Å—Ç—Ä–∞—Ç—É—Ä—ã.',
          effects:     { education: +1.2, digital: +1.5, sme_income: +0.8 },
          sideEffects: {}
        },

        // –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ —Å—Ä–µ–¥–∞
        {
          id: 'housing_construction',
          category: 'infra',
          name: '–°—Ç–∏–º—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∂–∏–ª–∏—â–Ω–æ–≥–æ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞',
          cost: 40,
          description: '–ñ–∏–ª—å—ë –∏ –≥–æ—Ä–æ–¥—Å–∫–æ–π —Ä–æ—Å—Ç.',
          effects:     { population: +0.5, poverty: -0.3 },
          sideEffects: { environment: -0.6 }
        },
        {
          id: 'public_transport',
          category: 'infra',
          name: '–†–∞–∑–≤–∏—Ç–∏–µ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞',
          cost: 30,
          description: '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç –∏ –º–æ–±–∏–ª—å–Ω–æ—Å—Ç—å.',
          effects:     { environment: +0.7, income: +0.3, trust: +0.2 },
          sideEffects: {}
        },
        {
          id: 'green_city',
          category: 'infra',
          name: '–†–µ–Ω–æ–≤–∞—Ü–∏—è –≥–æ—Ä–æ–¥—Å–∫–æ–π —Å—Ä–µ–¥—ã',
          cost: 35,
          description: '–ë–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∏ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞.',
          effects:     { environment: +1.5, trust: +0.6, sport: +0.8 },
          sideEffects: {}
        },
        {
          id: 'energy_efficiency',
          category: 'infra',
          name: '–ü—Ä–æ–≥—Ä–∞–º–º–∞ —ç–Ω–µ—Ä–≥–æ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏',
          cost: 25,
          description: '–°–Ω–∏–∂–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä—å –∏ –≤—ã–±—Ä–æ—Å–æ–≤.',
          effects:     { environment: +1.0, investment: +0.4 },
          sideEffects: {}
        },

        // –≠–∫–æ–Ω–æ–º–∏–∫–∞ –∏ —Ü–∏—Ñ—Ä–æ–≤–∏–∑–∞—Ü–∏—è
        {
          id: 'sme_subsidies',
          category: 'economy',
          name: '–°—É–±—Å–∏–¥–∏–∏ –¥–ª—è –ú–°–ü',
          cost: 35,
          description: '–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–∞–ª–æ–≥–æ –∏ —Å—Ä–µ–¥–Ω–µ–≥–æ –±–∏–∑–Ω–µ—Å–∞.',
          effects:     { sme_income: +1.5, income: +0.8, investment: +0.6 },
          sideEffects: { poverty: -0.2 }
        },
        {
          id: 'tax_reform',
          category: 'economy',
          name: '–ù–∞–ª–æ–≥–æ–≤–∞—è —Ä–µ—Ñ–æ—Ä–º–∞ –¥–ª—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π',
          cost: 25,
          description: '–°—Ç–∏–º—É–ª—ã –¥–ª—è –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤.',
          effects:     { investment: +1.5, income: +0.8 },
          sideEffects: { poverty: +0.3, trust: -0.3 }
        },
        {
          id: 'it_industry',
          category: 'economy',
          name: '–†–∞–∑–≤–∏—Ç–∏–µ IT-–∫–æ–º–ø–∞–Ω–∏–π',
          cost: 30,
          description: '–¢–µ—Ö–Ω–æ–ø–∞—Ä–∫–∏, –∞–∫—Å–µ–ª–µ—Ä–∞—Ç–æ—Ä—ã.',
          effects:     { digital: +2.0, sme_income: +1.0, income: +0.5 },
          sideEffects: { environment: -0.3 }
        },
        {
          id: 'tourism_clusters',
          category: 'economy',
          name: '–¢—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∫–ª–∞—Å—Ç–µ—Ä—ã',
          cost: 25,
          description: '–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç—É—Ä–∏–∑–º–∞.',
          effects:     { income: +0.7, investment: +0.5, environment: +0.4 },
          sideEffects: {}
        },
        {
          id: 'startups',
          category: 'economy',
          name: '–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç–∞—Ä—Ç–∞–ø–æ–≤',
          cost: 20,
          description: '–ò–Ω–∏—Ü–∏–∞—Ç–∏–≤—ã –ø–æ –∏–Ω–Ω–æ–≤–∞—Ü–∏—è–º.',
          effects:     { sme_income: +1.0, digital: +1.0, investment: +0.4 },
          sideEffects: { poverty: -0.1 }
        }
      ];

      const policiesMap = {};
      policies.forEach(p => { policiesMap[p.id] = p; });

      const budgetInfluence = {
        trust:      { social: +0.05, health: +0.02, edu: +0.02, infra: +0.01, economy: +0.01 },
        population: { social: +0.04, health: +0.03, infra: +0.02 },
        tfr:        { social: +0.04, health: +0.01, edu: +0.01 },
        life:       { health: +0.05, infra: +0.02 },
        poverty:    { social: -0.06, economy: -0.03 },
        sport:      { health: +0.04, infra: +0.02 },
        education:  { edu: +0.05 },
        income:     { economy: +0.06, infra: +0.02 },
        investment: { economy: +0.06, infra: +0.02 },
        sme_income: { economy: +0.05, edu: +0.02 },
        environment:{ infra: +0.05, economy: -0.02 },
        digital:    { economy: +0.05, edu: +0.02 }
      };

      // –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏
      const situationsConfig = [
        {
          id: 'eco_protests',
          name: '–≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ—Ç–µ—Å—Ç—ã',
          description: '–ñ–∏—Ç–µ–ª–∏ –Ω–µ–¥–æ–≤–æ–ª—å–Ω—ã —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –æ–∫—Ä—É–∂–∞—é—â–µ–π —Å—Ä–µ–¥—ã –∏ –≤—ã—Ö–æ–¥—è—Ç –Ω–∞ –ø—Ä–æ—Ç–µ—Å—Ç—ã.',
          trigger: {
            conditions: [
              { type: 'metric', id: 'environment', op: '<', value: 60 },
              { type: 'group',  id: 'activists',  op: '<', value: 55 }
            ]
          },
          resolve: {
            conditions: [
              { type: 'metric', id: 'environment', op: '>=', value: 70 },
              { type: 'group',  id: 'activists',  op: '>=', value: 60 }
            ]
          },
          metricsEffect: { trust: -0.7, investment: -0.4 }
        },
        {
          id: 'social_tension',
          name: '–°–æ—Ü–∏–∞–ª—å–Ω–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ',
          description: '–†–æ—Å—Ç –±–µ–¥–Ω–æ—Å—Ç–∏ –∏ –Ω–µ–¥–æ–≤–æ–ª—å—Å—Ç–≤–æ —Å–µ–º–µ–π –∏ –º–æ–ª–æ–¥—ë–∂–∏ —É—Å–∏–ª–∏–≤–∞—é—Ç —Å–æ—Ü–∏–∞–ª—å–Ω–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ.',
          trigger: {
            conditions: [
              { type: 'metric', id: 'poverty',  op: '>',  value: 12 },
              { type: 'group',  id: 'families', op: '<', value: 55 },
              { type: 'group',  id: 'youth',    op: '<', value: 55 }
            ]
          },
          resolve: {
            conditions: [
              { type: 'metric', id: 'poverty',  op: '<=', value: 10 },
              { type: 'group',  id: 'families', op: '>=', value: 60 },
              { type: 'group',  id: 'youth',    op: '>=', value: 60 }
            ]
          },
          metricsEffect: { trust: -0.8, population: -0.4, income: -0.4 }
        },
        {
          id: 'brain_drain',
          name: '–ö–∞–¥—Ä–æ–≤—ã–π –≥–æ–ª–æ–¥ –∏ –æ—Ç—Ç–æ–∫ –º–æ–ª–æ–¥—ë–∂–∏',
          description: '–ú–æ–ª–æ–¥—ã–µ –∏ –∫–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–∞–¥—Ä—ã —É–µ–∑–∂–∞—é—Ç –≤ –¥—Ä—É–≥–∏–µ —Ä–µ–≥–∏–æ–Ω—ã.',
          trigger: {
            conditions: [
              { type: 'metric', id: 'education', op: '<', value: 60 },
              { type: 'group',  id: 'youth',     op: '<', value: 50 }
            ]
          },
          resolve: {
            conditions: [
              { type: 'metric', id: 'education', op: '>=', value: 65 },
              { type: 'group',  id: 'youth',     op: '>=', value: 60 }
            ]
          },
          metricsEffect: { population: -0.5, sme_income: -0.5, investment: -0.3 }
        }
      ];

      // ----- –°–õ–£–ß–ê–ô–ù–´–ï –°–û–ë–´–¢–ò–Ø -----
      const events = [
        {
          id: 'meteorite',
          rare: true,
          title: '–ü–∞–¥–µ–Ω–∏–µ –º–µ—Ç–µ–æ—Ä–∏—Ç–∞',
          description: '–ù–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—é —Ä–µ–≥–∏–æ–Ω–∞ —É–ø–∞–ª –º–µ—Ç–µ–æ—Ä–∏—Ç. –í—ã–±–∏—Ç—ã —Å—Ç—ë–∫–ª–∞ –≤ –∂–∏–ª—ã—Ö –¥–æ–º–∞—Ö, –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞. –õ—é–¥–∏ –æ–∂–∏–¥–∞—é—Ç –±—ã—Å—Ç—Ä–æ–π —Ä–µ–∞–∫—Ü–∏–∏ –≤–ª–∞—Å—Ç–µ–π.',
          options: [
            {
              id: 'full_support',
              label: '–í—ã–¥–µ–ª–∏—Ç—å 1 –º–ª—Ä–¥ ‚ÇΩ –Ω–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ',
              description: '–ü–æ–ª–Ω–æ—Å—Ç—å—é –∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞—Ç—å —É—â–µ—Ä–± –∂–∏–ª—å—Ü–∞–º –∏ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞–º.',
              budgetDelta: -1,
              metrics: { trust: +1.5, poverty: -0.1 }
            },
            {
              id: 'minimal_support',
              label: '–û–≥—Ä–∞–Ω–∏—á–∏—Ç—å—Å—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π',
              description: '–°–æ–æ–±—â–∏—Ç—å, —á—Ç–æ –æ—Å–Ω–æ–≤–Ω—É—é –ø–æ–º–æ—â—å –æ–∫–∞–∂–µ—Ç —Ñ–µ–¥–µ—Ä–∞—Ü–∏—è, —Ä–µ–≥–∏–æ–Ω –ª–∏—à—å –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç.',
              budgetDelta: 0,
              metrics: { trust: -1.2 }
            }
          ]
        },
        {
          id: 'president_visit',
          rare: true,
          title: '–í–∏–∑–∏—Ç –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç–∞ –†–§',
          description: '–ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –≤–∏–∑–∏—Ç –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç–∞ –≤ —Ä–µ–≥–∏–æ–Ω —Å –∏–Ω—Å–ø–µ–∫—Ü–∏–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤.',
          options: [
            {
              id: 'decorate',
              label: '–ü–æ—Ç—Ä–∞—Ç–∏—Ç—å 3 –º–ª—Ä–¥ ‚ÇΩ –Ω–∞ –±–ª–∞–≥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∫ –≤–∏–∑–∏—Ç—É',
              description: '–°—Ä–æ—á–Ω—ã–π —Ä–µ–º–æ–Ω—Ç –¥–æ—Ä–æ–≥, —Ñ–∞—Å–∞–¥–æ–≤, –æ–∑–µ–ª–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã—Ö —É–ª–∏—Ü.',
              budgetDelta: -3,
              metrics: { trust: +1.0, environment: +0.5 }
            },
            {
              id: 'no_extra',
              label: '–û–≥—Ä–∞–Ω–∏—á–∏—Ç—å—Å—è —Ç–µ–∫—É—â–∏–º–∏ –ø–ª–∞–Ω–∞–º–∏',
              description: '–ë–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤, –ø–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≥–æ—Ä–æ–¥–∞.',
              budgetDelta: 0,
              metrics: { trust: -0.5 }
            }
          ]
        },
        {
          id: 'invest_forum',
          title: '–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–π —Ñ–æ—Ä—É–º',
          description: '–í–∞–º –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç –ø—Ä–æ–≤–µ—Å—Ç–∏ –≤ —Ä–µ–≥–∏–æ–Ω–µ –∫—Ä—É–ø–Ω—ã–π –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–π —Ñ–æ—Ä—É–º.',
          options: [
            {
              id: 'host_forum',
              label: '–ü—Ä–æ–≤–µ—Å—Ç–∏ —Ñ–æ—Ä—É–º (3 –º–ª—Ä–¥ ‚ÇΩ)',
              description: '–û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ, –ø—Ä–∏–≥–ª–∞—Å–∏—Ç—å –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤ –∏ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö —á–∏–Ω–æ–≤–Ω–∏–∫–æ–≤.',
              budgetDelta: -3,
              metrics: { investment: +2.0, income: +0.8, trust: +0.5 }
            },
            {
              id: 'decline_forum',
              label: '–û—Ç–∫–∞–∑–∞—Ç—å—Å—è –æ—Ç —Ñ–æ—Ä—É–º–∞',
              description: '–°—ç–∫–æ–Ω–æ–º–∏—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–∞, –Ω–æ —É–ø—É—Å—Ç–∏—Ç—å –∏–º–∏–¥–∂–µ–≤—ã–µ –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏.',
              budgetDelta: 0,
              metrics: { investment: -0.8 }
            }
          ]
        },
        {
          id: 'sport_event',
          rare: true,
          title: '–≠—Ç–∞–ø –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–≥–æ —Å–ø–æ—Ä—Ç–∏–≤–Ω–æ–≥–æ —Ç—É—Ä–Ω–∏—Ä–∞',
          description: '–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–∞—è —Ñ–µ–¥–µ—Ä–∞—Ü–∏—è –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø—Ä–æ–≤–µ—Å—Ç–∏ —ç—Ç–∞–ø —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–π –≤ –≤–∞—à–µ–º —Ä–µ–≥–∏–æ–Ω–µ.',
          options: [
            {
              id: 'host_sport',
              label: '–ü—Ä–æ–≤–µ—Å—Ç–∏ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–µ (2 –º–ª—Ä–¥ ‚ÇΩ)',
              description: '–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ/—Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∞—Ä–µ–Ω—ã, –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–π.',
              budgetDelta: -2,
              metrics: { sport: +3.0, trust: +0.8, investment: +0.5 }
            },
            {
              id: 'decline_sport',
              label: '–û—Ç–∫–∞–∑–∞—Ç—å—Å—è',
              description: '–†–µ–≥–∏–æ–Ω –Ω–µ –Ω–µ—Å—ë—Ç —Ä–∞—Å—Ö–æ–¥–æ–≤, –Ω–æ –æ—Å—Ç–∞—ë—Ç—Å—è –≤ —Å—Ç–æ—Ä–æ–Ω–µ –æ—Ç –ø–æ–≤–µ—Å—Ç–∫–∏.',
              budgetDelta: 0,
              metrics: { sport: -0.5 }
            }
          ]
        },
        {
          id: 'mining_open',
          title: '–û—Ç–∫—Ä—ã—Ç–∏–µ –∫—Ä—É–ø–Ω–æ–≥–æ –¥–æ–±—ã–≤–∞—é—â–µ–≥–æ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è',
          description: '–ò–Ω–≤–µ—Å—Ç–æ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç –Ω–æ–≤–æ–µ –≥–æ—Ä–Ω–æ–¥–æ–±—ã–≤–∞—é—â–µ–µ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ.',
          options: [
            {
              id: 'support_project',
              label: '–ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –∏ —É—Å–∫–æ—Ä–∏—Ç—å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è',
              description: '–°–æ–∑–¥–∞—Ç—å —Ä–∞–±–æ—á–∏–µ –º–µ—Å—Ç–∞ –∏ –Ω–æ–≤—ã–µ –Ω–∞–ª–æ–≥–æ–≤—ã–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è.',
              budgetDelta: 0,
              metrics: { income: +1.2, investment: +1.5, environment: -0.8, trust: +0.3 }
            },
            {
              id: 'strict_ecology',
              label: '–£–∂–µ—Å—Ç–æ—á–∏—Ç—å —ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è',
              description: '–ß–∞—Å—Ç—å –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π –º–æ–∂–µ—Ç —É–π—Ç–∏ –≤ –¥—Ä—É–≥–∏–µ —Ä–µ–≥–∏–æ–Ω—ã.',
              budgetDelta: 0,
              metrics: { environment: +1.2, investment: -0.8, trust: +0.2 }
            }
          ]
        },
        {
          id: 'plant_closure',
          title: '–ó–∞–∫—Ä—ã—Ç–∏–µ –≥—Ä–∞–¥–æ–æ–±—Ä–∞–∑—É—é—â–µ–≥–æ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è',
          description: '–ö—Ä—É–ø–Ω—ã–π –∑–∞–≤–æ–¥ –≤ –º–æ–Ω–æ–≥–æ—Ä–æ–¥–µ –æ–±—ä—è–≤–∏–ª –æ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞.',
          options: [
            {
              id: 'support_workers',
              label: '–í—ã–¥–µ–ª–∏—Ç—å 4 –º–ª—Ä–¥ ‚ÇΩ –Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫—É –∑–∞–Ω—è—Ç–æ—Å—Ç–∏',
              description: '–ü—Ä–æ–≥—Ä–∞–º–º—ã –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è –∏ —Å—É–±—Å–∏–¥–∏–∏ —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—è–º.',
              budgetDelta: -4,
              metrics: { poverty: -0.6, trust: +1.0, income: +0.3 }
            },
            {
              id: 'market_decides',
              label: '–ù–µ –≤–º–µ—à–∏–≤–∞—Ç—å—Å—è, –¥–∞—Ç—å —Ä—ã–Ω–∫—É –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è',
              description: '–≠–∫–æ–Ω–æ–º–∏—è –±—é–¥–∂–µ—Ç–∞, –Ω–æ —Å–æ—Ü–∏–∞–ª—å–Ω–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ —Ä–∞—Å—Ç—ë—Ç.',
              budgetDelta: 0,
              metrics: { poverty: +0.7, trust: -1.5, population: -0.6 }
            }
          ]
        },
        {
          id: 'flu_outbreak',
          title: '–†–æ—Å—Ç –∑–∞–±–æ–ª–µ–≤–∞–µ–º–æ—Å—Ç–∏ –≥—Ä–∏–ø–ø–æ–º',
          description: '–í —Ä–µ–≥–∏–æ–Ω–µ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –≤—Å–ø–ª–µ—Å–∫ —Å–µ–∑–æ–Ω–Ω—ã—Ö —Ä–µ—Å–ø–∏—Ä–∞—Ç–æ—Ä–Ω—ã—Ö –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π.',
          options: [
            {
              id: 'extra_health',
              label: '–í—ã–¥–µ–ª–∏—Ç—å 2 –º–ª—Ä–¥ ‚ÇΩ –Ω–∞ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫—É –∏ –ª–µ–∫–∞—Ä—Å—Ç–≤–∞',
              description: '–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –≤–∞–∫—Ü–∏–Ω—ã –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–π–∫–æ-–º–µ—Å—Ç–∞.',
              budgetDelta: -2,
              metrics: { life: +0.5, trust: +0.5 }
            },
            {
              id: 'no_extra_health',
              label: '–û–≥—Ä–∞–Ω–∏—á–∏—Ç—å—Å—è —Ç–µ–∫—É—â–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏',
              description: '–°–∏—Å—Ç–µ–º–∞ –∑–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø—Ä–µ–¥–µ–ª–µ.',
              budgetDelta: 0,
              metrics: { life: -0.3, trust: -0.5 }
            }
          ]
        },
        {
          id: 'flood',
          title: '–ù–∞–≤–æ–¥–Ω–µ–Ω–∏–µ –≤ –æ–¥–Ω–æ–º –∏–∑ —Ä–∞–π–æ–Ω–æ–≤',
          description: '–°–∏–ª—å–Ω—ã–µ –¥–æ–∂–¥–∏ –ø—Ä–∏–≤–µ–ª–∏ –∫ –ø–æ–¥—Ç–æ–ø–ª–µ–Ω–∏—é –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –Ω–∞—Å–µ–ª—ë–Ω–Ω—ã—Ö –ø—É–Ω–∫—Ç–æ–≤.',
          options: [
            {
              id: 'compensate',
              label: '–í—ã–¥–µ–ª–∏—Ç—å 3 –º–ª—Ä–¥ ‚ÇΩ –Ω–∞ –ª–∏–∫–≤–∏–¥–∞—Ü–∏—é –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π',
              description: '–ì–∞–∑–∏—Ñ–∏–∫–∞—Ü–∏—è, —Ä–µ–º–æ–Ω—Ç –¥–æ–º–æ–≤, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ—Ä–æ–≥.',
              budgetDelta: -3,
              metrics: { trust: +1.5, poverty: -0.4, environment: +0.3 }
            },
            {
              id: 'only_fed',
              label: '–ñ–¥–∞—Ç—å —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω–æ–π –ø–æ–º–æ—â–∏',
              description: '–†–µ–≥–∏–æ–Ω —Ñ–æ—Ä–º–∞–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–≤–æ–∏ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞, –Ω–æ –±–µ–∑ –¥–æ–ø. —Ä–∞—Å—Ö–æ–¥–æ–≤.',
              budgetDelta: 0,
              metrics: { trust: -1.0 }
            }
          ]
        },
        {
          id: 'fed_maternity',
          title: '–§–µ–¥–µ—Ä–∞–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–∞ –ø–æ –ø–æ–¥–¥–µ—Ä–∂–∫–µ —Å–µ–º–µ–π',
          description: '–§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π —Ü–µ–Ω—Ç—Ä –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Å–æ—Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –º–µ—Ä –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Å–µ–º–µ–π.',
          options: [
            {
              id: 'cofinance',
              label: '–°–æ—É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å (2 –º–ª—Ä–¥ ‚ÇΩ)',
              description: '–†–µ–≥–∏–æ–Ω –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –∫ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–º.',
              budgetDelta: -2,
              metrics: { tfr: +0.05, trust: +0.7, poverty: -0.2 }
            },
            {
              id: 'skip_cofinance',
              label: '–ù–µ —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —Å–æ—Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–∏',
              description: '–°—ç–∫–æ–Ω–æ–º–∏—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–∞ —Ä–µ–≥–∏–æ–Ω–∞, –Ω–æ –ø–æ–ª—É—á–∏—Ç—å –º–µ–Ω—å—à–µ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –¥–µ–Ω–µ–≥.',
              budgetDelta: 0,
              metrics: { tfr: -0.03, trust: -0.5 }
            }
          ]
        },
        {
          id: 'renovation_conflict',
          title: '–ö–æ–Ω—Ñ–ª–∏–∫—Ç –≤–æ–∫—Ä—É–≥ —Ä–∞—Å—Å–µ–ª–µ–Ω–∏—è –∞–≤–∞—Ä–∏–π–Ω–æ–≥–æ –∂–∏–ª—å—è',
          description: '–ß–∞—Å—Ç—å –∂–∏—Ç–µ–ª–µ–π –Ω–µ–¥–æ–≤–æ–ª—å–Ω–∞ —É—Å–ª–æ–≤–∏—è–º–∏ –ø–µ—Ä–µ—Å–µ–ª–µ–Ω–∏—è.',
          options: [
            {
              id: 'improve_terms',
              label: '–£–ª—É—á—à–∏—Ç—å —É—Å–ª–æ–≤–∏—è –∑–∞ —Å—á—ë—Ç –±—é–¥–∂–µ—Ç–∞ (2 –º–ª—Ä–¥ ‚ÇΩ)',
              description: '–ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –±–æ–ª—å—à—É—é –ø–ª–æ—â–∞–¥—å/–ª–æ–∫–∞—Ü–∏—é.',
              budgetDelta: -2,
              metrics: { trust: +1.2, environment: +0.3 }
            },
            {
              id: 'keep_plan',
              label: '–û—Å—Ç–∞–≤–∏—Ç—å —É—Å–ª–æ–≤–∏—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π',
              description: '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –±—é–¥–∂–µ—Ç, –Ω–æ —Å—Ç–æ–ª–∫–Ω—É—Ç—å—Å—è —Å –ø—Ä–æ—Ç–µ—Å—Ç–∞–º–∏.',
              budgetDelta: 0,
              metrics: { trust: -1.3 }
            }
          ]
        },
        {
          id: 'corruption_scandal',
          title: '–ö–æ—Ä—Ä—É–ø—Ü–∏–æ–Ω–Ω—ã–π —Å–∫–∞–Ω–¥–∞–ª –≤ –ø—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–µ —Ä–µ–≥–∏–æ–Ω–∞',
          description: '–û–¥–Ω–æ–≥–æ –∏–∑ –≤—ã—Å–æ–∫–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö —á–∏–Ω–æ–≤–Ω–∏–∫–æ–≤ –ø–æ–¥–æ–∑—Ä–µ–≤–∞—é—Ç –≤–æ –≤–∑—è—Ç–æ—á–Ω–∏—á–µ—Å—Ç–≤–µ.',
          options: [
            {
              id: 'punish_openly',
              label: '–ü—É–±–ª–∏—á–Ω–æ —É–≤–æ–ª–∏—Ç—å –∏ –ø–µ—Ä–µ–¥–∞—Ç—å –¥–µ–ª–æ –ø—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å–Ω—ã–º –æ—Ä–≥–∞–Ω–∞–º',
              description: '–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–µ—Ç–µ—Ä–ø–∏–º–æ—Å—Ç—å –∫ –∫–æ—Ä—Ä—É–ø—Ü–∏–∏.',
              budgetDelta: 0,
              metrics: { trust: +1.2, investment: +0.3 }
            },
            {
              id: 'quiet_resign',
              label: '–¢–∏—Ö–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ –æ—Ç—Å—Ç–∞–≤–∫—É –±–µ–∑ —à—É–º–∞',
              description: '–ü—ã—Ç–∞–µ—Ç–µ—Å—å —Å–≥–ª–∞–¥–∏—Ç—å —Å–∏—Ç—É–∞—Ü–∏—é, –Ω–æ –æ–±—â–µ—Å—Ç–≤–æ –¥–æ–≥–∞–¥—ã–≤–∞–µ—Ç—Å—è.',
              budgetDelta: 0,
              metrics: { trust: -1.5 }
            }
          ]
        },
        {
          id: 'anti_corruption',
          title: '–£—Å–ø–µ—à–Ω–∞—è –∞–Ω—Ç–∏–∫–æ—Ä—Ä—É–ø—Ü–∏–æ–Ω–Ω–∞—è –∫–∞–º–ø–∞–Ω–∏—è',
          description: '–†–µ–∑–æ–Ω–∞–Ω—Å–Ω–æ–µ –¥–µ–ª–æ –æ —Ö–∏—â–µ–Ω–∏—è—Ö –¥–æ–≤–µ–¥–µ–Ω–æ –¥–æ —Å—É–¥–∞ –∏ –ø—Ä–∏–≥–æ–≤–æ—Ä–∞.',
          options: [
            {
              id: 'media_support',
              label: '–®–∏—Ä–æ–∫–æ –æ—Å–≤–µ—â–∞—Ç—å —É—Å–ø–µ—Ö–∏ –≤ –°–ú–ò (0.5 –º–ª—Ä–¥ ‚ÇΩ)',
              description: '–§–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∏–º–∏–¥–∂ –Ω–µ—Ç–µ—Ä–ø–∏–º–æ—Å—Ç–∏ –∫ –∫–æ—Ä—Ä—É–ø—Ü–∏–∏.',
              budgetDelta: -0.5,
              metrics: { trust: +1.5, investment: +0.5 }
            },
            {
              id: 'no_media',
              label: '–ù–µ –∞–∫—Ü–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ',
              description: '–ë—é–¥–∂–µ—Ç —ç–∫–æ–Ω–æ–º–∏—Ç–µ, –Ω–æ —ç—Ñ—Ñ–µ–∫—Ç —Å–ª–∞–±–µ–µ.',
              budgetDelta: 0,
              metrics: { trust: +0.5 }
            }
          ]
        },
        {
          id: 'cyberattack',
          title: '–ö–∏–±–µ—Ä–∞—Ç–∞–∫–∞ –Ω–∞ —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã',
          description: '–ß–∞—Å—Ç—å –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã—Ö —É—Å–ª—É–≥ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞.',
          options: [
            {
              id: 'invest_cyber',
              label: '–°—Ä–æ—á–Ω–æ –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å 1.5 –º–ª—Ä–¥ ‚ÇΩ –≤ –∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å',
              description: '–£—Å–∏–ª–µ–Ω–∏–µ –∑–∞—â–∏—Ç—ã –∏ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ.',
              budgetDelta: -1.5,
              metrics: { digital: +1.5, trust: +0.3 }
            },
            {
              id: 'patch_minimal',
              label: '–û–≥—Ä–∞–Ω–∏—á–∏—Ç—å—Å—è –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –ª–∞—Ç–∫–∞–º–∏',
              description: '–î–µ—à–µ–≤–ª–µ —Å–µ–π—á–∞—Å, –Ω–æ —Ä–∏—Å–∫ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è –≤—ã—à–µ.',
              budgetDelta: 0,
              metrics: { digital: -0.8, trust: -0.3 }
            }
          ]
        },
        {
          id: 'digital_grant',
          title: '–§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –≥—Ä–∞–Ω—Ç –Ω–∞ —Ü–∏—Ñ—Ä–æ–≤–∏–∑–∞—Ü–∏—é',
          description: '–†–µ–≥–∏–æ–Ω –ø–æ–ª—É—á–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –º–æ–¥–µ—Ä–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ü–∏—Ñ—Ä–æ–≤—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É.',
          options: [
            {
              id: 'full_use',
              label: '–î–æ–±–∞–≤–∏—Ç—å 1 –º–ª—Ä–¥ ‚ÇΩ —Å–≤–æ–∏—Ö —Å—Ä–µ–¥—Å—Ç–≤ –∫ –≥—Ä–∞–Ω—Ç—É',
              description: '–£—Å–∏–ª–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç –ø—Ä–æ–≥—Ä–∞–º–º—ã.',
              budgetDelta: -1,
              metrics: { digital: +2.0, sme_income: +0.8 }
            },
            {
              id: 'use_minimum',
              label: '–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞',
              description: '–ë–µ–∑ –¥–æ–ø. –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –±—é–¥–∂–µ—Ç.',
              budgetDelta: 0,
              metrics: { digital: +1.0 }
            }
          ]
        },
        {
          id: 'forest_fire',
          title: '–õ–µ—Å–Ω—ã–µ –ø–æ–∂–∞—Ä—ã',
          description: '–í —É—Å–ª–æ–≤–∏—è—Ö –∂–∞—Ä—ã –∏ –≤–µ—Ç—Ä–∞ –≥–æ—Ä—è—Ç –ª–µ—Å–Ω—ã–µ –º–∞—Å—Å–∏–≤—ã.',
          options: [
            {
              id: 'extra_fire',
              label: '–í—ã–¥–µ–ª–∏—Ç—å 2 –º–ª—Ä–¥ ‚ÇΩ –Ω–∞ —Ç—É—à–µ–Ω–∏–µ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ',
              description: '–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ú–ß–°, –∞–≤–∏–∞—Ü–∏—è, –ø–æ—Å–∞–¥–∫–∞ –ª–µ—Å–∞.',
              budgetDelta: -2,
              metrics: { environment: +1.2, trust: +0.5 }
            },
            {
              id: 'base_fire',
              label: '–û–≥—Ä–∞–Ω–∏—á–∏—Ç—å—Å—è –±–∞–∑–æ–≤—ã–º —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ–º',
              description: '–ß–∞—Å—Ç—å –ª–µ—Å–æ–≤ –±—É–¥–µ—Ç —É—Ç—Ä–∞—á–µ–Ω–∞.',
              budgetDelta: 0,
              metrics: { environment: -1.0, trust: -0.5 }
            }
          ]
        },
        {
          id: 'eco_scandal',
          title: '–≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å–∫–∞–Ω–¥–∞–ª',
          description: '–û–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –æ–±–≤–∏–Ω—è–µ—Ç —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤–ª–∞—Å—Ç–∏ –≤ –±–µ–∑–¥–µ–π—Å—Ç–≤–∏–∏ –ø–æ –ø–æ–≤–æ–¥—É –≤—ã–±—Ä–æ—Å–æ–≤.',
          options: [
            {
              id: 'eco_monitor',
              label: '–í–≤–µ—Å—Ç–∏ –∂—ë—Å—Ç–∫–∏–π —ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (1 –º–ª—Ä–¥ ‚ÇΩ)',
              description: '–°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏ –≥–æ—Å–∫–æ–Ω—Ç—Ä–æ–ª—è.',
              budgetDelta: -1,
              metrics: { environment: +1.5, trust: +0.8, investment: -0.3 }
            },
            {
              id: 'ignore_eco',
              label: '–°–¥–µ–ª–∞—Ç—å –≤–∏–¥, —á—Ç–æ –ø—Ä–æ–±–ª–µ–º—ã –Ω–µ—Ç',
              description: '–ù–∞–¥–µ—è—Ç—å—Å—è, —á—Ç–æ —Å–∫–∞–Ω–¥–∞–ª –±—ã—Å—Ç—Ä–æ –∑–∞—Ç–∏—Ö–Ω–µ—Ç.',
              budgetDelta: 0,
              metrics: { environment: -0.8, trust: -1.3 }
            }
          ]
        },
        {
          id: 'tourism_boom',
          title: '–†–æ—Å—Ç –∏–Ω—Ç–µ—Ä–µ—Å–∞ –∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º—É —Ç—É—Ä–∏–∑–º—É',
          description: '–í–∞—à —Ä–µ–≥–∏–æ–Ω –ø–æ–ø–∞–ª –≤ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –±–ª–æ–≥–µ—Ä–æ–≤ –∏ —Ç—É—Ä–æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤.',
          options: [
            {
              id: 'invest_tourism',
              label: '–ò–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å 1.5 –º–ª—Ä–¥ ‚ÇΩ –≤ —Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É',
              description: '–ù–∞–≤–∏–≥–∞—Ü–∏—è, —Å–µ—Ä–≤–∏—Å, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å.',
              budgetDelta: -1.5,
              metrics: { income: +1.0, investment: +0.8, environment: -0.2 }
            },
            {
              id: 'no_tourism',
              label: '–ù–µ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –º–µ—Ä',
              description: '–°–ø—Ä–æ—Å –µ—Å—Ç—å, –Ω–æ —Å–µ—Ä–≤–∏—Å —Ö—Ä–æ–º–∞–µ—Ç.',
              budgetDelta: 0,
              metrics: { income: +0.3, trust: -0.2 }
            }
          ]
        },
        {
          id: 'data_center',
          rare: true,
          title: '–ö—Ä—É–ø–Ω–∞—è IT-–∫–æ–º–ø–∞–Ω–∏—è —Å—Ç—Ä–æ–∏—Ç –¥–∞—Ç–∞-—Ü–µ–Ω—Ç—Ä',
          description: '–ö–æ–º–ø–∞–Ω–∏—è –≥–æ—Ç–æ–≤–∞ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å –∫—Ä—É–ø–Ω—ã–π –¥–∞—Ç–∞-—Ü–µ–Ω—Ç—Ä –≤ —Ä–µ–≥–∏–æ–Ω–µ.',
          options: [
            {
              id: 'support_dc',
              label: '–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –Ω–∞–ª–æ–≥–æ–≤—ã–µ –ª—å–≥–æ—Ç—ã (–ø–æ—Ç–µ—Ä—è 1 –º–ª—Ä–¥ ‚ÇΩ –≤ –¥–æ—Ö–æ–¥–∞—Ö)',
              description: '–ü—Ä–∏–≤–ª–µ—á—å –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –∏ –≤—ã—Å–æ–∫–æ–æ–ø–ª–∞—á–∏–≤–∞–µ–º—ã–µ —Ä–∞–±–æ—á–∏–µ –º–µ—Å—Ç–∞.',
              budgetDelta: -1,
              metrics: { income: +0.8, sme_income: +1.0, digital: +1.5, investment: +1.2 }
            },
            {
              id: 'no_lg_dc',
              label: '–û—Ç–∫–∞–∑–∞—Ç—å –≤ –ª—å–≥–æ—Ç–∞—Ö',
              description: '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –¥–æ—Ö–æ–¥—ã –±—é–¥–∂–µ—Ç–∞.',
              budgetDelta: 0,
              metrics: { investment: -0.8, digital: -0.5 }
            }
          ]
        },
        {
          id: 'student_protest',
          title: '–°—Ç—É–¥–µ–Ω—á–µ—Å–∫–∏–µ –ø—Ä–æ—Ç–µ—Å—Ç—ã',
          description: '–°—Ç—É–¥–µ–Ω—Ç—ã –Ω–µ–¥–æ–≤–æ–ª—å–Ω—ã –∫–∞—á–µ—Å—Ç–≤–æ–º –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏ —É—Å–ª–æ–≤–∏—è–º–∏ –æ–±—â–µ–∂–∏—Ç–∏–π.',
          options: [
            {
              id: 'dialog_students',
              label: '–ü–æ–π—Ç–∏ –Ω–∞ –¥–∏–∞–ª–æ–≥ –∏ –≤–ª–æ–∂–∏—Ç—å 1 –º–ª—Ä–¥ ‚ÇΩ –≤ –∫–∞–º–ø—É—Å—ã',
              description: '–†–µ–º–æ–Ω—Ç –æ–±—â–µ–∂–∏—Ç–∏–π, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è.',
              budgetDelta: -1,
              metrics: { education: +1.3, trust: +0.8 }
            },
            {
              id: 'suppress_students',
              label: '–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è',
              description: '–°–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É –Ω–∞ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ–µ —Å–æ–±–ª—é–¥–µ–Ω–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π.',
              budgetDelta: 0,
              metrics: { education: -0.7, trust: -1.4 }
            }
          ]
        },
        {
          id: 'edu_success',
          title: '–£—Å–ø–µ—Ö–∏ —à–∫–æ–ª—å–Ω–∏–∫–æ–≤ —Ä–µ–≥–∏–æ–Ω–∞',
          description: '–£—á–µ–Ω–∏–∫–∏ —Ä–µ–≥–∏–æ–Ω–∞ –ø–æ–∫–∞–∑–∞–ª–∏ –≤—ã—Å–æ–∫–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ –ï–ì–≠ –∏ –æ–ª–∏–º–ø–∏–∞–¥–∞—Ö.',
          options: [
            {
              id: 'reward_teachers',
              label: '–ü—Ä–µ–º–∏—Ä–æ–≤–∞—Ç—å —É—á–∏—Ç–µ–ª–µ–π –∏ —à–∫–æ–ª—ã (0.8 –º–ª—Ä–¥ ‚ÇΩ)',
              description: '–£–∫—Ä–µ–ø–∏—Ç—å –º–æ—Ç–∏–≤–∞—Ü–∏—é –ø–µ–¥–∞–≥–æ–≥–æ–≤.',
              budgetDelta: -0.8,
              metrics: { education: +1.8, trust: +0.6 }
            },
            {
              id: 'just_announce',
              label: '–û–≥—Ä–∞–Ω–∏—á–∏—Ç—å—Å—è –ø—É–±–ª–∏—á–Ω—ã–º–∏ –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—è–º–∏',
              description: '–ë–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç.',
              budgetDelta: 0,
              metrics: { education: +0.6 }
            }
          ]
        },
        {
          id: 'family_year',
          title: '–ì–æ–¥ —Å–µ–º—å–∏ –≤ —Ä–µ–≥–∏–æ–Ω–µ',
          description: '–í—ã –º–æ–∂–µ—Ç–µ –æ–±—ä—è–≤–∏—Ç—å —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–π –≥–æ–¥ —Å–µ–º—å–∏ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –º–µ—Ä–∞–º–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏.',
          options: [
            {
              id: 'active_family',
              label: '–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É (1.5 –º–ª—Ä–¥ ‚ÇΩ)',
              description: '–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è, –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫–∞–º–ø–∞–Ω–∏–∏.',
              budgetDelta: -1.5,
              metrics: { tfr: +0.04, trust: +0.8, poverty: -0.2 }
            },
            {
              id: 'symbolic_family',
              label: '–û–≥—Ä–∞–Ω–∏—á–∏—Ç—å—Å—è —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫–∏–º–∏ –∞–∫—Ü–∏—è–º–∏',
              description: '–ë–µ–∑ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤.',
              budgetDelta: 0,
              metrics: { trust: +0.2 }
            }
          ]
        },
        {
          id: 'road_safety',
          title: '–ê–≤–∞—Ä–∏–π–Ω–æ—Å—Ç—å –Ω–∞ –¥–æ—Ä–æ–≥–∞—Ö',
          description: '–ù–∞ –æ–¥–Ω–æ–º –∏–∑ —É—á–∞—Å—Ç–∫–æ–≤ —Ç—Ä–∞—Å—Å—ã —Ä–µ–∑–∫–æ –≤—ã—Ä–æ—Å–ª–æ —á–∏—Å–ª–æ –î–¢–ü.',
          options: [
            {
              id: 'rebuild_road',
              label: '–†–µ–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞—Ç—å —É—á–∞—Å—Ç–æ–∫ (2 –º–ª—Ä–¥ ‚ÇΩ)',
              description: '–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –¥–æ—Ä–æ–≥–∏, —Ä–∞–∑–≤—è–∑–∫–∞, –æ—Å–≤–µ—â–µ–Ω–∏–µ.',
              budgetDelta: -2,
              metrics: { life: +0.4, trust: +0.4, environment: -0.2 }
            },
            {
              id: 'signs_only',
              label: '–û–≥—Ä–∞–Ω–∏—á–∏—Ç—å—Å—è –∑–Ω–∞–∫–∞–º–∏ –∏ –∫–∞–º–µ—Ä–∞–º–∏ (0.2 –º–ª—Ä–¥ ‚ÇΩ)',
              description: '–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –≤–ª–æ–∂–µ–Ω–∏—è, —ç—Ñ—Ñ–µ–∫—Ç –Ω–∏–∂–µ.',
              budgetDelta: -0.2,
              metrics: { life: +0.1 }
            }
          ]
        },
        {
          id: 'metro_project',
          rare: true,
          title: '–ü—Ä–æ–µ–∫—Ç —Å–∫–æ—Ä–æ—Å—Ç–Ω–æ–≥–æ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞',
          description: '–£–∫—Ä—É–ø–Ω—ë–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞ –ª–∏–Ω–∏–∏ –º–µ—Ç—Ä–æ/–ë–†–¢.',
          options: [
            {
              id: 'start_metro',
              label: '–°—Ç–∞—Ä—Ç–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç (3 –º–ª—Ä–¥ ‚ÇΩ –≤ –≥–æ–¥)',
              description: '–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è –≤ –º–æ–±–∏–ª—å–Ω–æ—Å—Ç—å.',
              budgetDelta: -3,
              metrics: { environment: +1.0, income: +0.5, trust: +0.5 }
            },
            {
              id: 'postpone_metro',
              label: '–û—Ç–ª–æ–∂–∏—Ç—å –ø—Ä–æ–µ–∫—Ç',
              description: '–°—ç–∫–æ–Ω–æ–º–∏—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–∞, –Ω–æ —É–ø—É—Å—Ç–∏—Ç—å –æ–∫–Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π.',
              budgetDelta: 0,
              metrics: { environment: -0.3, trust: -0.3 }
            }
          ]
        },
        {
          id: 'youth_outflow',
          title: '–û—Ç—Ç–æ–∫ –º–æ–ª–æ–¥—ë–∂–∏',
          description: '–ú–æ–ª–æ–¥—ã–µ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã —É–µ–∑–∂–∞—é—Ç –≤ –±–æ–ª–µ–µ –∫—Ä—É–ø–Ω—ã–µ –≥–æ—Ä–æ–¥–∞.',
          options: [
            {
              id: 'youth_program',
              label: '–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É —É–¥–µ—Ä–∂–∞–Ω–∏—è –º–æ–ª–æ–¥—ë–∂–∏ (1.5 –º–ª—Ä–¥ ‚ÇΩ)',
              description: '–ñ–∏–ª—å—ë, –≥—Ä–∞–Ω—Ç—ã, –∫–∞—Ä—å–µ—Ä–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏.',
              budgetDelta: -1.5,
              metrics: { population: +0.5, education: +0.5, income: +0.4, trust: +0.4 }
            },
            {
              id: 'no_youth_program',
              label: '–ù–µ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç—å –æ—Å–æ–±—ã—Ö –º–µ—Ä',
              description: '–ù–∞–¥–µ—è—Ç—å—Å—è –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—É—é —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—é.',
              budgetDelta: 0,
              metrics: { population: -0.7, income: -0.4 }
            }
          ]
        },
        {
          id: 'migrant_influx',
          title: '–ü—Ä–∏—Ç–æ–∫ —Ç—Ä—É–¥–æ–≤—ã—Ö –º–∏–≥—Ä–∞–Ω—Ç–æ–≤',
          description: '–í —Ä–µ–≥–∏–æ–Ω –ø—Ä–∏–±—ã–≤–∞–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∏–≥—Ä–∞–Ω—Ç–æ–≤.',
          options: [
            {
              id: 'integrate',
              label: '–ò–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å 1 –º–ª—Ä–¥ ‚ÇΩ –≤ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã',
              description: '–ö—É—Ä—Å—ã —è–∑—ã–∫–∞, –∞–¥–∞–ø—Ç–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ü–µ–Ω—Ç—Ä—ã.',
              budgetDelta: -1,
              metrics: { income: +0.7, population: +0.6, trust: +0.2 }
            },
            {
              id: 'ignore_migrants',
              label: '–ü—É—Å—Ç–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞ —Å–∞–º–æ—Ç—ë–∫',
              description: '–ë–µ–∑ —Ü–µ–ª–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã.',
              budgetDelta: 0,
              metrics: { trust: -0.6 }
            }
          ]
        },
        {
          id: 'bad_harvest',
          title: '–ù–µ—É—Ä–æ–∂–∞–π',
          description: '–°–ª–æ–∂–Ω—ã–µ –ø–æ–≥–æ–¥–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –ø—Ä–∏–≤–µ–ª–∏ –∫ –ø–ª–æ—Ö–æ–º—É —É—Ä–æ–∂–∞—é.',
          options: [
            {
              id: 'support_farmers',
              label: '–ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å —Å–µ–ª—å—Ö–æ–∑–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π (2 –º–ª—Ä–¥ ‚ÇΩ)',
              description: '–°—É–±—Å–∏–¥–∏–∏, –ª—å–≥–æ—Ç—ã –ø–æ –∫—Ä–µ–¥–∏—Ç–∞–º.',
              budgetDelta: -2,
              metrics: { poverty: -0.4, income: +0.3, trust: +0.5 }
            },
            {
              id: 'market_farm',
              label: '–û—Å—Ç–∞–≤–∏—Ç—å –≤—Å—ë —Ä—ã–Ω–∫—É',
              description: '–ú–Ω–æ–≥–∏–µ —Ö–æ–∑—è–π—Å—Ç–≤–∞ –º–æ–≥—É—Ç –æ–±–∞–Ω–∫—Ä–æ—Ç–∏—Ç—å—Å—è.',
              budgetDelta: 0,
              metrics: { poverty: +0.5, trust: -0.6 }
            }
          ]
        },
        {
          id: 'good_harvest',
          title: '–†–µ–∫–æ—Ä–¥–Ω—ã–π —É—Ä–æ–∂–∞–π',
          description: '–ê–≥—Ä–∞—Ä–Ω—ã–π —Å–µ–∫—Ç–æ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∫–æ—Ä–¥–Ω—ã–π —É—Ä–æ–∂–∞–π.',
          options: [
            {
              id: 'reserve_fund',
              label: '–°–æ–∑–¥–∞—Ç—å —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑–µ—Ä–≤–Ω—ã–π —Ñ–æ–Ω–¥',
              description: '–ß–∞—Å—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –¥–æ—Ö–æ–¥–∞ –Ω–∞–ø—Ä–∞–≤–∏—Ç—å –≤ —Ä–µ–∑–µ—Ä–≤—ã (+2 –º–ª—Ä–¥ ‚ÇΩ).',
              budgetDelta: +2,
              metrics: { income: +0.5, trust: +0.3 }
            },
            {
              id: 'spend_now',
              label: '–ù–∞–ø—Ä–∞–≤–∏—Ç—å –≤–µ—Å—å –¥–æ—Ö–æ–¥ –Ω–∞ —Ç–µ–∫—É—â–∏–µ —Ä–∞—Å—Ö–æ–¥—ã',
              description: '–ü–æ–≤—ã—Å–∏—Ç—å –∑–∞—Ä–ø–ª–∞—Ç—ã –∏ —Ç–µ–∫—É—â–∏–µ —Ç—Ä–∞—Ç—ã.',
              budgetDelta: +1,
              metrics: { trust: +0.7, poverty: -0.2 }
            }
          ]
        },
        {
          id: 'lockdown',
          rare: true,
          title: '–£–≥—Ä–æ–∑–∞ —ç–ø–∏–¥–µ–º–∏–∏',
          description: '–†–∞—Å—Ç—ë—Ç —á–∏—Å–ª–æ —Å–ª—É—á–∞–µ–≤ –æ–ø–∞—Å–Ω–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è. –û–±—Å—É–∂–¥–∞–µ—Ç—Å—è –≤–≤–µ–¥–µ–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π.',
          options: [
            {
              id: 'strict_lock',
              label: '–í–≤–µ—Å—Ç–∏ –∂—ë—Å—Ç–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è',
              description: '–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –º–∞—Å—Å–æ–≤—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –∏ —Ä–∞–±–æ—Ç—É –±–∏–∑–Ω–µ—Å–∞.',
              budgetDelta: 0,
              metrics: { life: +0.5, income: -0.7, trust: -0.2 }
            },
            {
              id: 'soft_lock',
              label: '–ú—è–≥–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –±–µ–∑ –∂—ë—Å—Ç–∫–∏—Ö –º–µ—Ä',
              description: '–≠–∫–æ–Ω–æ–º–∏–∫–∞ —Å—Ç—Ä–∞–¥–∞–µ—Ç –º–µ–Ω—å—à–µ, –Ω–æ —Ä–∏—Å–∫ –¥–ª—è –∑–¥–æ—Ä–æ–≤—å—è –≤—ã—à–µ.',
              budgetDelta: 0,
              metrics: { life: -0.3, trust: -0.1 }
            }
          ]
        },
        {
          id: 'startup_accel',
          title: '–ó–∞–ø—É—Å–∫ —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –∞–∫—Å–µ–ª–µ—Ä–∞—Ç–æ—Ä–∞ —Å—Ç–∞—Ä—Ç–∞–ø–æ–≤',
          description: '–í–ª–∞—Å—Ç–∏ –º–æ–≥—É—Ç –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –∞–∫—Å–µ–ª–µ—Ä–∞—Ç–æ—Ä–∞ –¥–ª—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤.',
          options: [
            {
              id: 'fund_accel',
              label: '–§–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞—Ç—å –∞–∫—Å–µ–ª–µ—Ä–∞—Ç–æ—Ä (1 –º–ª—Ä–¥ ‚ÇΩ)',
              description: '–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–º–∞–Ω–¥, –º–µ–Ω—Ç–æ—Ä—Å—Ç–≤–æ, –≥—Ä–∞–Ω—Ç—ã.',
              budgetDelta: -1,
              metrics: { sme_income: +1.2, digital: +1.0, investment: +0.5 }
            },
            {
              id: 'no_accel',
              label: '–ù–µ —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞—Ç—å',
              description: '–û—Å—Ç–∞–≤–∏—Ç—å —Ä–∞–∑–≤–∏—Ç–∏–µ —Å—Ç–∞—Ä—Ç–∞–ø–æ–≤ –Ω–∞ —á–∞—Å—Ç–Ω—ã–π —Å–µ–∫—Ç–æ—Ä.',
              budgetDelta: 0,
              metrics: { sme_income: -0.3 }
            }
          ]
        },
        {
          id: 'media_campaign',
          title: '–§–µ–¥–µ—Ä–∞–ª—å–Ω–∞—è –º–µ–¥–∏–∞–∫–∫–∞–º–ø–∞–Ω–∏—è –æ —Ä–µ–≥–∏–æ–Ω–µ',
          description: '–§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –°–ú–ò –≥–æ—Ç–æ–≤—ã —Å–Ω—è—Ç—å –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π —Ü–∏–∫–ª —Å—é–∂–µ—Ç–æ–≤ –æ —Ä–µ–≥–∏–æ–Ω–µ –ø—Ä–∏ –≤–∞—à–µ–º —Å–æ–¥–µ–π—Å—Ç–≤–∏–∏.',
          options: [
            {
              id: 'pay_media',
              label: '–£—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å (0.7 –º–ª—Ä–¥ ‚ÇΩ)',
              description: '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç—É—Ä—ã, PR-–ø–æ–¥–¥–µ—Ä–∂–∫–∞.',
              budgetDelta: -0.7,
              metrics: { trust: +1.0, investment: +0.4 }
            },
            {
              id: 'no_media_support',
              label: '–ù–µ —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å',
              description: '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–∞, –Ω–æ —É–ø—É—Å—Ç–∏—Ç—å –∏–º–∏–¥–∂–µ–≤—ã–µ –±–æ–Ω—É—Å—ã.',
              budgetDelta: 0,
              metrics: { trust: -0.2 }
            }
          ]
        }
      ];

      // ----- –°–æ—Å—Ç–æ—è–Ω–∏–µ -----
      let metrics = {};
      let currentYear = startYear;
      let selectedPolicies = new Set();
      let student = { fio: '', group: '' };
      let scenarioKey = 'baseline';
      let history = [];
      let chart = null;
      let budgetPieChart = null;
      let loadChart = null;

      let budgetBase = 800;   // –±–∞–∑–æ–≤—ã–π –¥–æ—Ö–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞, –º–ª—Ä–¥ ‚ÇΩ
      let investmentQueue = []; // –º–∞—Å—Å–∏–≤ {amount, yearsLeft, multiplier}
      let lastRevenue = budgetBase;
      let lastSpendable = budgetBase;
      let lastInvested = 0;
      let lastMatured = 0;

      let yearSteps = [];
      let timelineInitialized = false;

      // –°–æ–±—ã—Ç–∏—è
      let currentEvent = null;
      let currentEventChoiceId = null;
      let commonEventsPool = [];
      let rareEventsPool = [];
      let eventLog = [];

      // –ì—Ä—É–ø–ø—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–∞—Å–µ–ª–µ–Ω–∏—è
      let groupSupport = {};        // { groupId: 0..100 }
      let publicSupportIndex = 0;   // 0..100

      // –°–∏—Ç—É–∞—Ü–∏–∏
      let situationsState = [];     // [{config, active}]

      // ----- DOM -----
      const introDiv     = document.getElementById('intro');
      const gameDiv      = document.getElementById('game');
      const yearLabel    = document.getElementById('yearLabel');
      const studentLabel = document.getElementById('studentLabel');
      const scenarioLabel= document.getElementById('scenarioLabel');
      const scoreLabel   = document.getElementById('scoreLabel');
      const supportLabel = document.getElementById('supportLabel');

      const yearTimelineDiv = document.getElementById('yearTimeline');

      const eventCardDiv        = document.getElementById('eventCard');
      const eventYearLabel      = document.getElementById('eventYearLabel');
      const eventTitleEl        = document.getElementById('eventTitle');
      const eventDescriptionEl  = document.getElementById('eventDescription');
      const eventOptionsDiv     = document.getElementById('eventOptions');
      const eventBadgeEl        = document.getElementById('eventBadge');

      const eventLogDiv         = document.getElementById('eventLog');

      const budgetInputsDiv = document.getElementById('budgetInputs');
      const budgetSummaryDiv= document.getElementById('budgetSummary');
      const budgetMoneyDiv  = document.getElementById('budgetMoney');

      const taxLevelSelect       = document.getElementById('taxLevel');
      const investmentShareInput = document.getElementById('investmentShare');
      const investmentHorizonSel = document.getElementById('investmentHorizon');

      const policyContainer = document.getElementById('policyContainer');
      const policyCountSpan = document.getElementById('policyCount');
      const policyLimitSpan = document.getElementById('policyLimit');
      const activePoliciesView = document.getElementById('activePoliciesView');

      const metricsTableBody = document.getElementById('metricsTableBody');
      const evaluationDiv    = document.getElementById('evaluation');

      const groupsTableBody = document.getElementById('groupsTableBody');
      const situationsListDiv = document.getElementById('situationsList');

      const startBtn  = document.getElementById('startBtn');
      const nextBtn   = document.getElementById('nextBtn');
      const resetBtn  = document.getElementById('resetBtn');

      policyLimitSpan.textContent = maxPolicies.toString();

      // ----- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è -----

      function initMetrics() {
        metrics = {};
        metricsConfig.forEach(m => {
          let value = m.base;
          const scn = scenarios[scenarioKey];
          if (scn && scn.mods && scn.mods[m.id] !== undefined) {
            value += scn.mods[m.id];
          }
          metrics[m.id] = clamp(value, m.min, m.max);
        });
      }

      function initBudgetInputs() {
        budgetInputsDiv.innerHTML = '';
        categories.forEach(cat => {
          const row = document.createElement('div');
          row.className = 'budget-input-row';

          const label = document.createElement('span');
          label.className = 'budget-label';
          label.textContent = cat.name;

          const input = document.createElement('input');
          input.type = 'number';
          input.min = '0';
          input.max = '100';
          input.step = '1';
          input.value = '20';
          input.dataset.categoryId = cat.id;
          input.addEventListener('input', updateBudgetSummary);

          const amountSpan = document.createElement('span');
          amountSpan.className = 'budget-amount';
          amountSpan.textContent = '‚âà 0.0 –º–ª—Ä–¥ ‚ÇΩ';

          row.appendChild(label);
          row.appendChild(input);
          row.appendChild(amountSpan);
          budgetInputsDiv.appendChild(row);
        });
        updateBudgetSummary();
      }

      function updateBudgetSummary() {
        const inputs = budgetInputsDiv.querySelectorAll('input[type="number"]');
        let total = 0;
        const values = [];
        inputs.forEach(inp => {
          const v = parseFloat(inp.value.replace(',', '.')) || 0;
          total += v;
          values.push(v);

          const row = inp.parentElement;
          const amountSpan = row.querySelector('.budget-amount');
          if (amountSpan) {
            const share = v / 100;
            const amount = share * lastSpendable;
            amountSpan.textContent = '‚âà ' + (isFinite(amount) ? amount.toFixed(1) : '0.0') + ' –º–ª—Ä–¥ ‚ÇΩ';
          }
        });
        budgetSummaryDiv.textContent = '–ò—Ç–æ–≥–æ –ø–æ –±–ª–æ–∫–∞–º: ' + total.toFixed(0) + '% (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 100%)';
        updateBudgetPieChart(values);
      }

      function splitPolicyEffects(p) {
        const pos = [];
        const neg = [];
        const all = Object.assign({}, p.effects || {}, p.sideEffects || {});
        for (const [id, delta] of Object.entries(all)) {
          if (delta === 0) continue;
          const m = metricsConfig.find(m => m.id === id);
          if (!m) continue;
          if (delta > 0) pos.push(m.name);
          else neg.push(m.name);
        }
        return { pos, neg };
      }

      function createPolicyPanel() {
        policyContainer.innerHTML = '';
        const groups = {};
        policies.forEach(p => {
          if (!groups[p.category]) groups[p.category] = [];
          groups[p.category].push(p);
        });

        Object.keys(groups).forEach(catId => {
          groups[catId].sort((a, b) => a.name.localeCompare(b.name, 'ru'));
        });

        categories.forEach(cat => {
          const list = groups[cat.id] || [];
          if (!list.length) return;

          const catDiv = document.createElement('div');
          catDiv.className = 'policy-category';

          const title = document.createElement('div');
          title.className = 'policy-category-title';
          title.textContent = cat.name;
          catDiv.appendChild(title);

          list.forEach(p => {
            const item = document.createElement('div');
            item.className = 'policy-item';

            const header = document.createElement('div');
            header.className = 'policy-item-header';

            const main = document.createElement('div');
            main.className = 'policy-item-main';

            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            checkbox.id = 'policy-' + p.id;
            checkbox.dataset.policyId = p.id;

            const iconSpan = document.createElement('span');
            iconSpan.className = 'policy-icon';
            iconSpan.textContent = getPolicyIcon(p);

            const label = document.createElement('label');
            label.setAttribute('for', checkbox.id);
            label.className = 'policy-name';
            label.textContent = p.name;

            main.appendChild(checkbox);
            main.appendChild(iconSpan);
            main.appendChild(label);

            const costBadge = document.createElement('div');
            costBadge.className = 'policy-cost-badge';
            costBadge.textContent = '–°—Ç–æ–∏–º–æ—Å—Ç—å: ' + p.cost + ' –º–ª—Ä–¥ ‚ÇΩ/–≥–æ–¥';

            header.appendChild(main);
            header.appendChild(costBadge);
            item.appendChild(header);

            const descDiv = document.createElement('div');
            descDiv.className = 'policy-desc';
            descDiv.textContent = p.description;
            item.appendChild(descDiv);

            const { pos, neg } = splitPolicyEffects(p);
            if (pos.length > 0) {
              const row = document.createElement('div');
              row.className = 'policy-effects-row';
              const lbl = document.createElement('span');
              lbl.className = 'effects-label pos';
              lbl.textContent = '–£–ª—É—á—à–∞–µ—Ç:';
              row.appendChild(lbl);
              pos.forEach(name => {
                const tag = document.createElement('span');
                tag.className = 'policy-tag positive';
                tag.textContent = name;
                row.appendChild(tag);
              });
              item.appendChild(row);
            }
            if (neg.length > 0) {
              const row = document.createElement('div');
              row.className = 'policy-effects-row';
              const lbl = document.createElement('span');
              lbl.className = 'effects-label neg';
              lbl.textContent = '–†–∏—Å–∫–∏:';
              row.appendChild(lbl);
              neg.forEach(name => {
                const tag = document.createElement('span');
                tag.className = 'policy-tag negative';
                tag.textContent = name;
                row.appendChild(tag);
              });
              item.appendChild(row);
            }

            catDiv.appendChild(item);
          });

          policyContainer.appendChild(catDiv);
        });

        policyCountSpan.textContent = '0';
        updateActivePoliciesView();
      }

      function buildMetricsTable() {
        metricsTableBody.innerHTML = '';
        metricsConfig.forEach(m => {
          const tr = document.createElement('tr');

          const tdName = document.createElement('td');
          tdName.textContent = m.name;
          tr.appendChild(tdName);

          const tdCurrent = document.createElement('td');
          tdCurrent.id = 'metric-current-' + m.id;
          tdCurrent.style.textAlign = 'right';
          tr.appendChild(tdCurrent);

          const tdTarget = document.createElement('td');
          tdTarget.textContent = m.target;
          tdTarget.style.textAlign = 'right';
          tr.appendChild(tdTarget);

          const tdProgress = document.createElement('td');
          const bar = document.createElement('div');
          bar.className = 'metric-progress';
          const inner = document.createElement('div');
          inner.className = 'metric-progress-inner';
          inner.id = 'metric-progress-' + m.id;
          bar.appendChild(inner);
          tdProgress.appendChild(bar);
          tr.appendChild(tdProgress);

          const tdInfluence = document.createElement('td');
          tdInfluence.id = 'metric-influencers-' + m.id;
          tdInfluence.style.fontSize = '0.75rem';
          tdInfluence.style.color = '#444';
          tr.appendChild(tdInfluence);

          metricsTableBody.appendChild(tr);
        });
      }

      function initScoreChart() {
        const ctx = document.getElementById('scoreChart').getContext('2d');
        chart = new Chart(ctx, {
          type: 'line',
          data: {
            labels: [],
            datasets: [{
              label: '–ò–Ω–¥–µ–∫—Å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏',
              data: [],
              fill: false,
              tension: 0.15
            }]
          },
          options: {
            responsive: true,
            scales: {
              y: {
                min: 0,
                max: 100,
                ticks: { stepSize: 20 }
              }
            }
          }
        });
      }

      function initBudgetPieChart() {
        const ctx = document.getElementById('budgetPie').getContext('2d');
        budgetPieChart = new Chart(ctx, {
          type: 'pie',
          data: {
            labels: categories.map(c => c.name),
            datasets: [{
              data: categories.map(() => 20)
            }]
          },
          options: {
            responsive: true,
            plugins: {
              legend: {
                position: 'bottom'
              }
            }
          }
        });
      }

      function updateBudgetPieChart(values) {
        if (!budgetPieChart) return;
        if (!values || values.length === 0) return;
        budgetPieChart.data.datasets[0].data = values;
        budgetPieChart.update();
      }

      function initLoadChart() {
        const ctx = document.getElementById('loadChart').getContext('2d');
        loadChart = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: categories.map(c => c.name),
            datasets: [
              {
                label: '–î–æ—Å—Ç—É–ø–Ω—ã–π –±—é–¥–∂–µ—Ç (–º–ª—Ä–¥ ‚ÇΩ)',
                data: categories.map(() => 0)
              },
              {
                label: '–°—Ç–æ–∏–º–æ—Å—Ç—å –º–µ—Ä (–º–ª—Ä–¥ ‚ÇΩ)',
                data: categories.map(() => 0)
              }
            ]
          },
          options: {
            responsive: true,
            scales: {
              x: { stacked: false },
              y: {
                beginAtZero: true
              }
            },
            plugins: {
              legend: {
                position: 'bottom'
              }
            }
          }
        });
      }

      function updateLoadChart(categoryBudgetBn, requiredBn) {
        if (!loadChart) return;
        const available = categories.map(cat => categoryBudgetBn[cat.id] || 0);
        const used = categories.map(cat => requiredBn[cat.id] || 0);
        loadChart.data.datasets[0].data = available.map(v => round1(v));
        loadChart.data.datasets[1].data = used.map(v => round1(v));
        loadChart.update();
      }

      function renderTimeline() {
        if (!yearTimelineDiv) return;
        yearTimelineDiv.innerHTML = '';
        yearSteps = [];
        for (let y = startYear; y <= endYear; y++) {
          const step = document.createElement('div');
          step.className = 'timeline-step';
          step.dataset.year = y;

          const circle = document.createElement('div');
          circle.className = 'timeline-circle';
          const label = document.createElement('div');
          label.className = 'timeline-label';
          label.textContent = y;

          step.appendChild(circle);
          step.appendChild(label);
          yearTimelineDiv.appendChild(step);
          yearSteps.push(step);

          if (y < endYear) {
            const connector = document.createElement('div');
            connector.style.flex = '0 0 20px';
            connector.style.height = '2px';
            connector.style.background = '#d0d4e5';
            connector.style.margin = '0 2px';
            yearTimelineDiv.appendChild(connector);
          }
        }
        timelineInitialized = true;
        updateTimeline();
      }

      function updateTimeline() {
        if (!timelineInitialized) return;
        yearSteps.forEach(step => {
          const y = parseInt(step.dataset.year, 10);
          step.classList.remove('past', 'current', 'future');
          if (y < currentYear) step.classList.add('past');
          else if (y === currentYear) step.classList.add('current');
          else step.classList.add('future');
        });
      }

      function initChartsIfNeeded() {
        if (!chart) initScoreChart();
        if (!budgetPieChart) initBudgetPieChart();
        if (!loadChart) initLoadChart();
        updateBudgetSummary();
      }

      function computeOverallScore() {
        let sum = 0;
        let sumWeights = 0;
        metricsConfig.forEach(m => {
          let value = metrics[m.id];
          let ratio;
          if (m.inverted) {
            const best = m.target;
            const worst = m.max;
            ratio = (worst - value) / (worst - best);
          } else {
            const best = m.target;
            const worst = m.min;
            ratio = (value - worst) / (best - worst);
          }
          ratio = Math.max(0, Math.min(1.3, ratio));
          sum += ratio * m.weight;
          sumWeights += m.weight;
        });
        const score = (sum / sumWeights) * 100;
        return Math.max(0, Math.min(100, score));
      }

      // –ù–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏ (0‚Äì100) –¥–ª—è –≥—Ä—É–ø–ø
      function getMetricAchievement(metricId) {
        const m = metricsConfig.find(x => x.id === metricId);
        if (!m) return 50;
        const value = metrics[metricId];
        let best = m.target;
        let worst = m.min;
        let ratio;
        if (m.inverted) {
          best = m.target;
          worst = m.max;
          if (worst === best) return 100;
          ratio = (worst - value) / (worst - best);
        } else {
          if (best === worst) return 100;
          ratio = (value - worst) / (best - worst);
        }
        ratio = clamp(ratio, 0, 1);
        return ratio * 100;
      }

      // –ì—Ä—É–ø–ø—ã –Ω–∞—Å–µ–ª–µ–Ω–∏—è –∏ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞
      function computeGroupSupport() {
        const gs = {};
        groupsConfig.forEach(g => {
          let sumScore = 0;
          let sumW = 0;
          for (const [metricId, w] of Object.entries(g.metrics || {})) {
            const mScore = getMetricAchievement(metricId);
            sumScore += mScore * w;
            sumW += w;
          }
          let groupScore = sumW > 0 ? (sumScore / sumW) : 50;
          groupScore = clamp(groupScore, 0, 100);
          gs[g.id] = groupScore;
        });
        groupSupport = gs;

        let total = 0;
        let totalW = 0;
        groupsConfig.forEach(g => {
          const w = g.electorateWeight || 0;
          total += (groupSupport[g.id] || 0) * w;
          totalW += w;
        });
        publicSupportIndex = totalW > 0 ? (total / totalW) : 0;
        publicSupportIndex = clamp(publicSupportIndex, 0, 100);
      }

      function updateGroupSupportUI() {
        if (!groupsTableBody) return;
        groupsTableBody.innerHTML = '';
        groupsConfig.forEach(g => {
          const tr = document.createElement('tr');

          const tdName = document.createElement('td');
          tdName.textContent = g.name;

          const tdShare = document.createElement('td');
          tdShare.style.textAlign = 'right';
          tdShare.textContent = Math.round((g.electorateWeight || 0) * 100) + '%';

          const tdVal = document.createElement('td');
          const val = groupSupport[g.id] !== undefined ? groupSupport[g.id] : 50;
          tdVal.style.textAlign = 'right';
          tdVal.textContent = val.toFixed(1);

          const tdBar = document.createElement('td');
          const bar = document.createElement('div');
          bar.className = 'metric-progress';
          const inner = document.createElement('div');
          inner.className = 'metric-progress-inner';
          inner.style.width = val.toFixed(0) + '%';
          inner.classList.add(val >= 70 ? 'good' : (val >= 40 ? 'medium' : 'bad'));
          bar.appendChild(inner);
          tdBar.appendChild(bar);

          tr.appendChild(tdName);
          tr.appendChild(tdShare);
          tr.appendChild(tdVal);
          tr.appendChild(tdBar);
          groupsTableBody.appendChild(tr);
        });

        if (supportLabel) {
          supportLabel.textContent = publicSupportIndex.toFixed(1) + ' / 100';
        }
      }

      function getTopPolicyInfluences(metricId) {
        const influences = [];
        selectedPolicies.forEach(pid => {
          const p = policiesMap[pid];
          if (!p) return;
          let delta = 0;
          if (p.effects && p.effects[metricId]) delta += p.effects[metricId];
          if (p.sideEffects && p.sideEffects[metricId]) delta += p.sideEffects[metricId];
          if (delta !== 0) {
            influences.push({ policy: p, delta });
          }
        });
        influences.sort((a, b) => Math.abs(b.delta) - Math.abs(a.delta));
        return influences.slice(0, 3);
      }

      function updateMetricsUI() {
        metricsConfig.forEach(m => {
          const value = metrics[m.id];
          const td = document.getElementById('metric-current-' + m.id);
          if (td) td.textContent = value.toFixed(2);

          const progressDiv = document.getElementById('metric-progress-' + m.id);
          if (progressDiv) {
            let progress;
            if (m.inverted) {
              const start = m.base;
              const best = m.target;
              if (start === best) {
                progress = 1;
              } else {
                progress = (start - value) / (start - best);
              }
            } else {
              const diff = m.target - m.base;
              if (diff === 0) {
                progress = 1;
              } else {
                progress = (value - m.base) / diff;
              }
            }
            progress = clamp(progress, 0, 1);
            progressDiv.style.width = (progress * 100).toFixed(0) + '%';
            progressDiv.classList.remove('good', 'medium', 'bad');
            if (progress >= 0.8) {
              progressDiv.classList.add('good');
            } else if (progress >= 0.5) {
              progressDiv.classList.add('medium');
            } else {
              progressDiv.classList.add('bad');
            }
          }

          const inflTd = document.getElementById('metric-influencers-' + m.id);
          if (inflTd) {
            const infl = getTopPolicyInfluences(m.id);
            if (infl.length === 0) {
              inflTd.textContent = '‚Äî';
            } else {
              inflTd.innerHTML = '';
              infl.forEach((entry, idx) => {
                if (idx > 0) inflTd.appendChild(document.createTextNode(' '));
                const span = document.createElement('span');
                span.className = 'policy-tag';
                if (entry.delta > 0) span.classList.add('positive');
                else span.classList.add('negative');
                const arrow = entry.delta > 0 ? '‚Üë' : '‚Üì';
                span.textContent = getPolicyIcon(entry.policy) + ' ' + arrow;
                inflTd.appendChild(span);
              });
            }
          }
        });

        const score = computeOverallScore();
        scoreLabel.textContent = score.toFixed(1);
      }

      function updateBudgetMoneyUI(revenue, invested, spendable, matured) {
        budgetMoneyDiv.textContent =
          '–î–æ—Ö–æ–¥ –±—é–¥–∂–µ—Ç–∞ –≤ —ç—Ç–æ–º –≥–æ–¥—É: ' + revenue.toFixed(0) + ' –º–ª—Ä–¥ ‚ÇΩ ' +
          (matured > 0 ? '(–≤ —Ç.—á. –≤–æ–∑–≤—Ä–∞—Ç –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π: ' + matured.toFixed(0) + ' –º–ª—Ä–¥ ‚ÇΩ); ' : '; ') +
          '–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–π —Ñ–æ–Ω–¥: ' + invested.toFixed(0) + ' –º–ª—Ä–¥ ‚ÇΩ; ' +
          '–¥–æ—Å—Ç—É–ø–Ω–æ –Ω–∞ —Ç–µ–∫—É—â–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏ —Å–æ–±—ã—Ç–∏—è: ' + spendable.toFixed(0) + ' –º–ª—Ä–¥ ‚ÇΩ.';
      }

      function updateActivePoliciesView() {
        if (!activePoliciesView) return;
        if (selectedPolicies.size === 0) {
          activePoliciesView.textContent = '–ê–∫—Ç–∏–≤–Ω—ã–µ –º–µ—Ä—ã: –Ω–µ—Ç';
          return;
        }
        activePoliciesView.textContent = '';
        const label = document.createElement('span');
        label.style.fontWeight = '500';
        label.style.marginRight = '4px';
        label.textContent = '–ê–∫—Ç–∏–≤–Ω—ã–µ –º–µ—Ä—ã:';
        activePoliciesView.appendChild(label);

        selectedPolicies.forEach(pid => {
          const p = policiesMap[pid];
          if (!p) return;
          const chip = document.createElement('span');
          chip.className = 'policy-tag positive';
          chip.textContent = getPolicyIcon(p) + ' ' + p.name;
          activePoliciesView.appendChild(chip);
        });
      }

      // ----- –°–∏—Ç—É–∞—Ü–∏–∏ -----
      function initSituationsState() {
        situationsState = situationsConfig.map(cfg => ({
          config: cfg,
          active: false
        }));
      }

      function getConditionValue(cond) {
        if (cond.type === 'metric') {
          return metrics[cond.id] !== undefined ? metrics[cond.id] : 0;
        }
        if (cond.type === 'group') {
          return groupSupport[cond.id] !== undefined ? groupSupport[cond.id] : 0;
        }
        return 0;
      }

      function checkSingleCondition(cond) {
        const v = getConditionValue(cond);
        const t = cond.value;
        switch (cond.op) {
          case '<':  return v <  t;
          case '<=': return v <= t;
          case '>':  return v >  t;
          case '>=': return v >= t;
          default:   return false;
        }
      }

      function checkConditionsAll(conditions) {
        if (!conditions || !conditions.length) return true;
        return conditions.every(checkSingleCondition);
      }

      function updateSituationsActivation() {
        if (!situationsState || !situationsState.length) return;
        situationsState.forEach(state => {
          const cfg = state.config;
          if (state.active) {
            if (cfg.resolve && checkConditionsAll(cfg.resolve.conditions || [])) {
              state.active = false;
            }
          } else {
            if (cfg.trigger && checkConditionsAll(cfg.trigger.conditions || [])) {
              state.active = true;
            }
          }
        });
      }

      function applySituationEffectsToDelta(metricId, delta) {
        if (!situationsState) return delta;
        situationsState.forEach(state => {
          if (!state.active) return;
          const eff = state.config.metricsEffect || {};
          if (eff[metricId]) {
            delta += eff[metricId];
          }
        });
        return delta;
      }

      function renderSituationsList() {
        if (!situationsListDiv) return;
        const active = situationsState.filter(s => s.active);
        if (!active.length) {
          situationsListDiv.textContent = '–°–µ–π—á–∞—Å –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏–π. –ü—Ä–∏ –Ω–µ–±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö –æ–Ω–∏ –º–æ–≥—É—Ç –ø–æ—è–≤–∏—Ç—å—Å—è.';
          return;
        }
        situationsListDiv.innerHTML = '';
        active.forEach(state => {
          const cfg = state.config;
          const div = document.createElement('div');
          div.className = 'situation-item';

          const title = document.createElement('div');
          title.className = 'situation-title';
          title.textContent = cfg.name;

          const desc = document.createElement('div');
          desc.className = 'situation-desc';
          desc.textContent = cfg.description;

          const eff = document.createElement('div');
          eff.className = 'situation-effects';
          const parts = [];
          const mEff = cfg.metricsEffect || {};
          for (const [mid, d] of Object.entries(mEff)) {
            const mc = metricsConfig.find(m => m.id === mid);
            if (!mc) continue;
            const sign = d > 0 ? '+' : '';
            parts.push(mc.name + ': ' + sign + d.toFixed(2) + ' –≤ –≥–æ–¥');
          }
          eff.textContent = '–ï–∂–µ–≥–æ–¥–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç: ' + (parts.length ? parts.join('; ') : '–Ω–µ—Ç');

          div.appendChild(title);
          div.appendChild(desc);
          div.appendChild(eff);
          situationsListDiv.appendChild(div);
        });
      }

      // ----- –°–æ–±—ã—Ç–∏—è -----
      function resetEventsPool() {
        commonEventsPool = [];
        rareEventsPool = [];
        events.forEach(ev => {
          if (ev.rare) rareEventsPool.push(ev);
          else commonEventsPool.push(ev);
        });
      }

      function generateNewEvent() {
        if (!eventCardDiv) return;
        if (currentYear > endYear) {
          eventCardDiv.classList.add('hidden');
          return;
        }

        if (!commonEventsPool.length && !rareEventsPool.length) {
          resetEventsPool();
        }

        const rareChance = 0.2;
        let useRare = (Math.random() < rareChance) && rareEventsPool.length > 0;
        let pool = useRare ? rareEventsPool : commonEventsPool;

        if (!pool.length && (rareEventsPool.length || commonEventsPool.length)) {
          pool = rareEventsPool.length ? rareEventsPool : commonEventsPool;
          useRare = (pool === rareEventsPool);
        }

        if (!pool.length) {
          currentEvent = null;
          currentEventChoiceId = null;
          renderCurrentEvent();
          return;
        }

        const idx = Math.floor(Math.random() * pool.length);
        currentEvent = pool.splice(idx, 1)[0];
        currentEventChoiceId = null;
        renderCurrentEvent();
      }

      function renderCurrentEvent() {
        if (!currentEvent) {
          eventYearLabel.textContent = '';
          eventTitleEl.textContent = '–°–æ–±—ã—Ç–∏—è –Ω–µ—Ç';
          eventDescriptionEl.textContent = '';
          eventOptionsDiv.innerHTML = '';
          if (eventBadgeEl) eventBadgeEl.innerHTML = '';
          eventCardDiv.classList.remove('event-rare');
          return;
        }
        eventCardDiv.classList.remove('hidden');
        eventYearLabel.textContent = '–ì–æ–¥: ' + currentYear;
        eventTitleEl.textContent = currentEvent.title;
        eventDescriptionEl.textContent = currentEvent.description;
        eventOptionsDiv.innerHTML = '';

        if (eventBadgeEl) {
          if (currentEvent.rare) {
            eventBadgeEl.innerHTML = '<span class="event-badge-rare">–†–µ–¥–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ</span>';
            eventCardDiv.classList.add('event-rare');
          } else {
            eventBadgeEl.innerHTML = '';
            eventCardDiv.classList.remove('event-rare');
          }
        }

        currentEvent.options.forEach(opt => {
          const wrap = document.createElement('div');
          wrap.className = 'event-option';
          const label = document.createElement('label');
          const radio = document.createElement('input');
          radio.type = 'radio';
          radio.name = 'eventOption';
          radio.value = opt.id;
          label.appendChild(radio);
          const strong = document.createElement('strong');
          strong.textContent = ' ' + opt.label;
          label.appendChild(strong);
          if (opt.description) {
            const spanDesc = document.createElement('span');
            spanDesc.textContent = ' ‚Äî ' + opt.description;
            label.appendChild(spanDesc);
          }
          wrap.appendChild(label);
          eventOptionsDiv.appendChild(wrap);
        });
      }

      function renderEventLog() {
        if (!eventLogDiv) return;
        if (!eventLog.length) {
          eventLogDiv.textContent = '–ü–æ–∫–∞ –Ω–µ—Ç —Å–æ–±—ã—Ç–∏–π.';
          return;
        }
        eventLogDiv.innerHTML = '';
        eventLog.forEach(entry => {
          const row = document.createElement('div');
          row.className = 'event-log-item';
          if (entry.rare) row.classList.add('rare');

          const yearSpan = document.createElement('span');
          yearSpan.className = 'event-log-year';
          yearSpan.textContent = entry.year + ':';

          const titleSpan = document.createElement('span');
          titleSpan.className = 'event-log-title';
          titleSpan.textContent = ' ' + entry.title;

          const choiceSpan = document.createElement('span');
          choiceSpan.className = 'event-log-choice';
          choiceSpan.textContent = ' ‚Äî ' + entry.optionLabel;

          row.appendChild(yearSpan);
          row.appendChild(titleSpan);
          row.appendChild(choiceSpan);

          eventLogDiv.appendChild(row);
        });
      }

      // ----- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ -----
      function onPolicyCheckboxChange(e) {
        const cb = e.target;
        if (cb.tagName !== 'INPUT' || cb.type !== 'checkbox') return;
        const pid = cb.dataset.policyId;
        if (!pid) return;
        if (cb.checked) {
          if (selectedPolicies.size >= maxPolicies) {
            alert('–ù–µ–ª—å–∑—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å –±–æ–ª–µ–µ ' + maxPolicies + ' –º–µ—Ä. –°–Ω–∏–º–∏—Ç–µ –≥–∞–ª–æ—á–∫—É —Å –¥—Ä—É–≥–æ–π –º–µ—Ä—ã.');
            cb.checked = false;
            return;
          }
          selectedPolicies.add(pid);
        } else {
          selectedPolicies.delete(pid);
        }
        policyCountSpan.textContent = selectedPolicies.size.toString();
        updateActivePoliciesView();
      }

      function startGame() {
        const fio = document.getElementById('fio').value.trim();
        const group = document.getElementById('group').value.trim();
        const scenarioSelect = document.getElementById('scenario');

        if (!fio || !group) {
          alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –§–ò–û –∏ –Ω–æ–º–µ—Ä –≥—Ä—É–ø–ø—ã.');
          return;
        }

        student.fio = fio;
        student.group = group;
        scenarioKey = scenarioSelect.value || 'baseline';

        selectedPolicies = new Set();
        currentYear = startYear;

        investmentQueue = [];
        budgetBase = 800;
        lastRevenue = budgetBase;
        lastSpendable = budgetBase;
        lastInvested = 0;
        lastMatured = 0;
        taxLevelSelect.value = 'medium';
        investmentShareInput.value = 10;
        investmentHorizonSel.value = 3;
        budgetMoneyDiv.textContent = '–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —Ö–æ–¥–∞ –ø–æ—è–≤–∏—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ—Ö–æ–¥–∞—Ö –±—é–¥–∂–µ—Ç–∞ (–º–ª—Ä–¥ ‚ÇΩ).';

        initMetrics();
        initBudgetInputs();
        createPolicyPanel();
        buildMetricsTable();
        initChartsIfNeeded();
        history = [];

        // –ì—Ä—É–ø–ø—ã –∏ —Å–∏—Ç—É–∞—Ü–∏–∏
        computeGroupSupport();
        updateGroupSupportUI();
        initSituationsState();
        updateSituationsActivation();
        renderSituationsList();

        // –°–æ–±—ã—Ç–∏—è
        resetEventsPool();
        eventLog = [];
        renderEventLog();
        generateNewEvent();

        introDiv.classList.add('hidden');
        gameDiv.classList.remove('hidden');
        evaluationDiv.classList.add('hidden');
        evaluationDiv.innerHTML = '';

        studentLabel.textContent = fio + ' (–≥—Ä—É–ø–ø–∞ ' + group + ')';
        scenarioLabel.textContent = scenarios[scenarioKey].name;
        yearLabel.textContent = currentYear.toString();
        policyCountSpan.textContent = '0';

        if (!timelineInitialized) {
          renderTimeline();
        } else {
          updateTimeline();
        }

        const score = computeOverallScore();
        history.push({ year: currentYear, score });
        updateMetricsUI();
        updateChart();
      }

      function updateChart() {
        if (!chart) return;
        chart.data.labels = history.map(h => h.year.toString());
        chart.data.datasets[0].data = history.map(h => h.score);
        chart.update();
      }

      function processYear() {
        if (currentYear > endYear) return;

        // 1. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –±–ª–æ–∫–∞–º
        const inputs = budgetInputsDiv.querySelectorAll('input[type="number"]');
        const budgetsPercent = {};
        let total = 0;
        inputs.forEach(inp => {
          const v = parseFloat(inp.value.replace(',', '.')) || 0;
          budgetsPercent[inp.dataset.categoryId] = v;
          total += v;
        });
        if (Math.round(total) !== 100) {
          alert('–°—É–º–º–∞ –±—é–¥–∂–µ—Ç–∞ –ø–æ –±–ª–æ–∫–∞–º –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ä–∞–≤–Ω–∞ 100%. –°–µ–π—á–∞—Å: ' + total.toFixed(1) + '%.');
          return;
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–±–æ—Ä–∞ —Å–æ–±—ã—Ç–∏—è
        if (currentEvent && !currentEventChoiceId) {
          alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç —Ä–µ—à–µ–Ω–∏—è –ø–æ —Å–æ–±—ã—Ç–∏—é –≥–æ–¥–∞.');
          return;
        }

        let eventMetrics = {};
        let eventBudgetDelta = 0;
        let chosenOption = null;
        if (currentEvent && currentEventChoiceId) {
          chosenOption = currentEvent.options.find(o => o.id === currentEventChoiceId);
          if (chosenOption) {
            eventMetrics = chosenOption.metrics || {};
            if (typeof chosenOption.budgetDelta === 'number') {
              eventBudgetDelta = chosenOption.budgetDelta;
            }
          }
        }

        // 2. –ù–∞–ª–æ–≥–æ–≤–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ ‚Äî –¥–æ—Ö–æ–¥ –±—é–¥–∂–µ—Ç–∞
        const incomeIndex = metrics.income;
        let base = budgetBase * (incomeIndex / 100.0);

        let taxDelta = {};
        let taxFactor = 1.0;
        const taxLevel = taxLevelSelect.value;
        if (taxLevel === 'low') {
          taxFactor = 0.9;
          taxDelta.trust = +0.4;
          taxDelta.income = +0.5;
          taxDelta.poverty = -0.3;
        } else if (taxLevel === 'high') {
          taxFactor = 1.1;
          taxDelta.trust = -0.4;
          taxDelta.income = -0.5;
          taxDelta.poverty = +0.3;
        }

        // –û—á–µ—Ä–µ–¥—å –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π
        let maturedReturn = 0;
        const newQueue = [];
        investmentQueue.forEach(inv => {
          const updated = { ...inv, yearsLeft: inv.yearsLeft - 1 };
          if (updated.yearsLeft <= 0) {
            maturedReturn += updated.amount * updated.multiplier;
          } else {
            newQueue.push(updated);
          }
        });
        investmentQueue = newQueue;

        let revenueBeforeInvest = base * taxFactor + maturedReturn;

        // –ù–æ–≤—ã–µ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏
        let investShare = parseFloat(investmentShareInput.value.replace(',', '.')) || 0;
        if (investShare < 0) investShare = 0;
        if (investShare > 30) investShare = 30;
        investmentShareInput.value = investShare.toFixed(0);

        const horizonYears = parseInt(investmentHorizonSel.value, 10) || 3;
        let investmentAmount = revenueBeforeInvest * (investShare / 100.0);

        let spendableBudget = revenueBeforeInvest - investmentAmount;
        if (spendableBudget < 0) {
          alert('–î–æ–ª—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π —Å–ª–∏—à–∫–æ–º –≤–µ–ª–∏–∫–∞: –Ω–µ –æ—Å—Ç–∞—ë—Ç—Å—è —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ —Ç–µ–∫—É—â–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã.');
          return;
        }

        if (investmentAmount > 1) {
          const multiplier = 1 + 0.18 * horizonYears;
          investmentQueue.push({
            amount: investmentAmount,
            yearsLeft: horizonYears,
            multiplier
          });
        }

        // 3. –ë—é–¥–∂–µ—Ç –ø–æ –±–ª–æ–∫–∞–º (–º–ª—Ä–¥ ‚ÇΩ)
        const shares = {};
        const categoryBudgetBn = {};
        categories.forEach(cat => {
          const share = (budgetsPercent[cat.id] || 0) / 100.0;
          shares[cat.id] = share;
          categoryBudgetBn[cat.id] = spendableBudget * share;
        });

        // 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –º–µ—Ä
        const requiredBn = {};
        categories.forEach(cat => requiredBn[cat.id] = 0);
        selectedPolicies.forEach(pid => {
          const p = policiesMap[pid];
          if (p) requiredBn[p.category] += p.cost;
        });

        const overloaded = [];
        categories.forEach(cat => {
          if (requiredBn[cat.id] > categoryBudgetBn[cat.id] + 1e-6) {
            overloaded.push(
              cat.name + ': —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞ –º–µ—Ä—ã ' + requiredBn[cat.id].toFixed(1) +
              ' –º–ª—Ä–¥ ‚ÇΩ, –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –±—é–¥–∂–µ—Ç—É ' + categoryBudgetBn[cat.id].toFixed(1) + ' –º–ª—Ä–¥ ‚ÇΩ'
            );
          }
        });
        if (overloaded.length > 0) {
          alert(
            '–í—ã –≤—ã–±—Ä–∞–ª–∏ —Å–ª–∏—à–∫–æ–º –¥–æ—Ä–æ–≥–æ–π –ø–∞–∫–µ—Ç –º–µ—Ä –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π:\n\n' +
            overloaded.join('\n') +
            '\n\n–£–º–µ–Ω—å—à–∏—Ç–µ –Ω–∞–±–æ—Ä –º–µ—Ä –∏–ª–∏ –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –±—é–¥–∂–µ—Ç –ø–æ –±–ª–æ–∫–∞–º.'
          );
          return;
        }

        // 5. –£—á–∏—Ç—ã–≤–∞–µ–º –±—é–¥–∂–µ—Ç —Å–æ–±—ã—Ç–∏—è
        if (eventBudgetDelta !== 0) {
          if (spendableBudget + eventBudgetDelta < 0) {
            alert('–° —É—á—ë—Ç–æ–º –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è –ø–æ —Å–æ–±—ã—Ç–∏—é –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç —Å—Ä–µ–¥—Å—Ç–≤ –≤ –±—é–¥–∂–µ—Ç–µ. –í—ã–±–µ—Ä–∏—Ç–µ –¥—Ä—É–≥–æ–π –≤–∞—Ä–∏–∞–Ω—Ç —Å–æ–±—ã—Ç–∏—è –∏–ª–∏ —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–π—Ç–µ –±—é–¥–∂–µ—Ç.');
            return;
          }
          spendableBudget += eventBudgetDelta;
        }

        lastRevenue = revenueBeforeInvest;
        lastSpendable = spendableBudget;
        lastInvested = investmentAmount;
        lastMatured = maturedReturn;
        updateBudgetMoneyUI(lastRevenue, lastInvested, lastSpendable, lastMatured);

        updateLoadChart(categoryBudgetBn, requiredBn);
        updateBudgetSummary(); // –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å —Å—É–º–º—ã –≤ –º–ª—Ä–¥ ‚ÇΩ –ø–æ –Ω–æ–≤—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º

        // 6. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø –∏ —Å–∏—Ç—É–∞—Ü–∏–π (–Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π)
        computeGroupSupport();
        updateGroupSupportUI();
        updateSituationsActivation();
        renderSituationsList();

        // 7. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ KPI
        metricsConfig.forEach(m => {
          let value = metrics[m.id];

          const drift = (m.target - value) * 0.01;
          let delta = drift;

          const bInf = budgetInfluence[m.id] || {};
          for (const [catId, coeff] of Object.entries(bInf)) {
            const diff = shares[catId] - 0.2;
            delta += coeff * diff * 50;
          }

          selectedPolicies.forEach(pid => {
            const p = policiesMap[pid];
            if (!p) return;
            if (p.effects && p.effects[m.id] !== undefined) {
              delta += p.effects[m.id];
            }
            if (p.sideEffects && p.sideEffects[m.id] !== undefined) {
              delta += p.sideEffects[m.id];
            }
          });

          if (taxDelta[m.id]) {
            delta += taxDelta[m.id];
          }

          if (eventMetrics[m.id]) {
            delta += eventMetrics[m.id];
          }

          // —ç—Ñ—Ñ–µ–∫—Ç—ã –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏–π
          delta = applySituationEffectsToDelta(m.id, delta);

          value += delta;
          value = clamp(value, m.min, m.max);
          metrics[m.id] = round2(value);
        });

        // 8. –ì—Ä—É–ø–ø—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–∞—Å–µ–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è KPI
        computeGroupSupport();
        updateGroupSupportUI();

        // 9. –õ–æ–≥ —Å–æ–±—ã—Ç–∏–π
        if (currentEvent && chosenOption) {
          eventLog.push({
            year: currentYear,
            title: currentEvent.title,
            optionLabel: chosenOption.label,
            rare: !!currentEvent.rare
          });
          renderEventLog();
        }

        // 10. –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≥–æ–¥—É
        currentYear += 1;
        yearLabel.textContent = currentYear.toString();
        updateTimeline();

        const score = computeOverallScore();
        history.push({ year: currentYear, score });
        updateMetricsUI();
        updateChart();

        if (currentYear > endYear) {
          endGame();
        } else {
          generateNewEvent();
        }
      }

      function endGame() {
        nextBtn.disabled = true;

        const finalScore = computeOverallScore();
        computeGroupSupport(); // –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π –æ–±–Ω–æ–≤–∏–º –ø–æ–¥–¥–µ—Ä–∂–∫—É
        updateGroupSupportUI();

        const grade =
          finalScore >= 85 ? 'A (–æ—Ç–ª–∏—á–Ω–æ)' :
          finalScore >= 70 ? 'B (—Ö–æ—Ä–æ—à–æ)' :
          finalScore >= 55 ? 'C (—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ)' :
                             'D (–Ω–µ—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ)';

        let supportText;
        if (publicSupportIndex >= 70) {
          supportText = '–í—ã—Å–æ–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–∞—Å–µ–ª–µ–Ω–∏—è.';
        } else if (publicSupportIndex >= 50) {
          supportText = '–°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –Ω–∞—Å–µ–ª–µ–Ω–∏—è.';
        } else {
          supportText = '–ù–∏–∑–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–∞—Å–µ–ª–µ–Ω–∏—è.';
        }

        let comboText = '';
        if (finalScore >= 70 && publicSupportIndex < 50) {
          comboText = '–í—ã –¥–æ–±–∏–ª–∏—Å—å —Ö–æ—Ä–æ—à–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π —Ñ–æ—Ä–º–∞–ª—å–Ω—ã—Ö KPI, –Ω–æ –ø—Ä–æ–∏–≥—Ä–∞–ª–∏ –ø–æ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–µ ‚Äî –Ω–∞—Å–µ–ª–µ–Ω–∏–µ –≤ —Ü–µ–ª–æ–º –Ω–µ–¥–æ–≤–æ–ª—å–Ω–æ –ø—Ä–æ–≤–æ–¥–∏–º–æ–π –ø–æ–ª–∏—Ç–∏–∫–æ–π.';
        } else if (finalScore < 55 && publicSupportIndex >= 70) {
          comboText = '–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Å–ª–∞–±–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞–ª—å–Ω—ã—Ö KPI, –≤—ã —Å–º–æ–≥–ª–∏ —É–¥–µ—Ä–∂–∞—Ç—å –≤—ã—Å–æ–∫—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É –Ω–∞—Å–µ–ª–µ–Ω–∏—è. –¢–∞–∫–∞—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–æ–ª–≥–æ –Ω–µ—É—Å—Ç–æ–π—á–∏–≤–∞, –Ω–æ –≤–æ–∑–º–æ–∂–Ω–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–π –ø–æ–ª–∏—Ç–∏–∫–µ.';
        } else if (finalScore >= 70 && publicSupportIndex >= 70) {
          comboText = '–í–∞–º —É–¥–∞–ª–æ—Å—å —Å–æ–≤–º–µ—Å—Ç–∏—Ç—å —Ö–æ—Ä–æ—à–∏–µ KPI –∏ –≤—ã—Å–æ–∫—É—é –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É ‚Äî —Ä–µ–¥–∫–∏–π, –Ω–æ –æ—á–µ–Ω—å –∂–µ–ª–∞–µ–º—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –¥–ª—è –≥—É–±–µ—Ä–Ω–∞—Ç–æ—Ä–∞.';
        } else {
          comboText = '–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ KPI –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–µ –Ω–∞—Å–µ–ª–µ–Ω–∏—è –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–π –∑–æ–Ω–µ: –µ—Å—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è, –Ω–æ –∏ —Å–µ—Ä—å—ë–∑–Ω—ã–µ —Ä–∏—Å–∫–∏, —Ç—Ä–µ–±—É—é—â–∏–µ –≤–Ω–∏–º–∞–Ω–∏—è.';
        }

        evaluationDiv.classList.remove('hidden');
        evaluationDiv.innerHTML = `
          <h3>–ò—Ç–æ–≥–æ–≤–æ–µ –∑–∞–∫–ª—é—á–µ–Ω–∏–µ</h3>
          <p><strong>–°—Ç—É–¥–µ–Ω—Ç:</strong> ${escapeHtml(student.fio)}<br/>
          <strong>–ì—Ä—É–ø–ø–∞:</strong> ${escapeHtml(student.group)}</p>
          <p><strong>–°—Ü–µ–Ω–∞—Ä–∏–π:</strong> ${scenarios[scenarioKey].name}</p>
          <p><strong>–ì–æ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:</strong> ${currentYear}</p>
          <p><strong>–û–±—â–∏–π –∏–Ω–¥–µ–∫—Å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (KPI):</strong> ${finalScore.toFixed(1)} –∏–∑ 100</p>
          <p><strong>–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–∞—Å–µ–ª–µ–Ω–∏—è:</strong> ${publicSupportIndex.toFixed(1)} –∏–∑ 100 (${supportText})</p>
          <p><strong>–§–æ—Ä–º–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –ø–æ KPI:</strong> ${grade}</p>
          <p style="font-size:0.9rem;">${comboText}</p>
          <p style="font-size:0.85rem; color:#555;">
            –í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç —Å–∫—Ä–∏–Ω—à–æ—Ç –∫–∞–∫ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è.
          </p>
        `;
      }

      function resetGame() {
        if (!confirm('–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ? –í—Å–µ —Ç–µ–∫—É—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã.')) return;
        nextBtn.disabled = false;
        introDiv.classList.remove('hidden');
        gameDiv.classList.add('hidden');
      }

      function clamp(v, min, max) {
        return Math.max(min, Math.min(max, v));
      }
      function round2(v) {
        return Math.round(v * 100) / 100;
      }
      function round1(v) {
        return Math.round(v * 10) / 10;
      }
      function escapeHtml(str) {
        return String(str).replace(/[&<>"']/g, s => ({
          '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;'
        }[s]));
      }

      // –°–ª—É—à–∞—Ç–µ–ª–∏
      policyContainer.addEventListener('change', onPolicyCheckboxChange);
      if (eventOptionsDiv) {
        eventOptionsDiv.addEventListener('change', e => {
          if (e.target && e.target.name === 'eventOption') {
            currentEventChoiceId = e.target.value;
          }
        });
      }
      startBtn.addEventListener('click', startGame);
      nextBtn.addEventListener('click', processYear);
      resetBtn.addEventListener('click', resetGame);
    });
  </script>
</body>
</html>
